(()=>{"use strict";var t={};function e(t,e,i,o,s){this.gl=t,this.vertex=e,this.fragment=i,this.uniforms=o,this.atribs=s;var n=t.createProgram();t.attachShader(n,e),t.attachShader(n,i),t.linkProgram(n);var r=this;if(!t.getProgramParameter(n,t.LINK_STATUS))throw"could not compile shader:"+t.getProgramInfoLog(n);o.forEach((function(e){r[e]=t.getUniformLocation(n,e)})),s.forEach((function(e){r[e]=t.getAttribLocation(n,e)})),t.useProgram(n),this.program=n}function i(t){var e=Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z);return t.x=t.x/e,t.y=t.y/e,t.z=t.z/e,t}function o(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}function s(t,e){return{x:t.y*e.z-t.z*e.y,y:t.z*e.x-t.x*e.z,z:t.x*e.y-t.y*e.x}}function n(t,e){return{x:t.x-e.x,y:t.y-e.y,z:t.z-e.z}}t.isGLfloat="undefined"!=typeof Float32Array,t.pomararay=t.isGLfloat?new Float32Array(16):new Array(16),t.pomararay3=t.isGLfloat?new Float32Array(9):new Array(9),t.getInit3=function(){return t.isGLfloat?t.indentZerro3(new Float32Array(9)):[1,0,0,0,1,0,0,0,1]},t.getInit=function(){return t.isGLfloat?t.indentZerro(new Float32Array(16)):[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},t.indentZerro=function(t){return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},t.indentZerro3=function(t){return t[0]=1,t[4]=1,t[8]=1,t},t.indentCopy=t.getInit(),t.indent=function(e){for(var i=0;i<16;i++)e[i]=t.indentCopy[i]},t.perspective=function(e,i,o,s){var n=t.isGLfloat?new Float32Array(16):new Array(16),r=1/Math.tan(e/2);return n[0]=r/i,n[5]=r,n[10]=(s+o)/(o-s),n[14]=-1,n[11]=2*s*o/(o-s),n},t.orthogonal=function(e,i,o,s){var n=t.isGLfloat?new Float32Array(16):new Array(16);return n[0]=2/e/i,n[5]=2/e,n[10]=-2/(s-o),n[14]=-(o+s)/(s-o),n[15]=1,n},t.rotate=function(e,i,o,s){var n=o[0],r=o[1],a=o[2];s||(s=t.isGLfloat?new Float32Array(16):new Array(16));var h=1-Math.cos(i),l=Math.sin(i),d=Math.cos(i);return s[0]=n*n*h+d,s[4]=r*n*h-a*l,s[8]=a*n*h+r*l,s[1]=n*n*h+a*l,s[5]=r*r*h+d,s[9]=a*n*h-n*l,s[2]=n*a*h-r*l,s[6]=r*a*h+n*l,s[10]=a*a*h+d,s[15]=1,t.multiplay(s,e)},t.rotatef=function(e,i,o,s){var n=o[0],r=o[1],a=o[2];s||(s=t.pomararay);var h=t.pomararay3,l=1-Math.cos(i),d=Math.sin(i),c=Math.cos(i);return h[0]=n*n*l+c,h[1]=n*r*l+a*d,h[2]=n*a*l-r*d,h[3]=r*n*l-a*d,h[4]=r*r*l+c,h[5]=r*a*l+n*d,h[6]=a*n*l+r*d,h[7]=a*r*l-n*d,h[8]=a*a*l+c,s[0]=h[0]*e[0]+h[1]*e[4]+h[2]*e[8],s[1]=h[0]*e[1]+h[1]*e[5]+h[2]*e[9],s[2]=h[0]*e[2]+h[1]*e[6]+h[2]*e[10],s[3]=h[0]*e[3]+h[1]*e[7]+h[2]*e[11],s[4]=h[3]*e[0]+h[4]*e[4]+h[5]*e[8],s[5]=h[3]*e[1]+h[4]*e[5]+h[5]*e[9],s[6]=h[3]*e[2]+h[4]*e[6]+h[5]*e[10],s[7]=h[3]*e[3]+h[4]*e[7]+h[5]*e[11],s[8]=h[6]*e[0]+h[7]*e[4]+h[8]*e[8],s[9]=h[6]*e[1]+h[7]*e[5]+h[8]*e[9],s[10]=h[6]*e[2]+h[7]*e[6]+h[8]*e[10],s[11]=h[6]*e[3]+h[7]*e[7]+h[8]*e[11],e[0]=s[0],e[1]=s[1],e[2]=s[2],e[3]=s[3],e[4]=s[4],e[5]=s[5],e[6]=s[6],e[7]=s[7],e[8]=s[8],e[9]=s[9],e[10]=s[10],e[11]=s[11],e},t.translate=function(e,i){var o=i[0],s=i[1],n=i[2],r=t.getInit();return r[12]+=o,r[13]+=s,r[14]+=n,t.multiplay(r,e)},t.translatef=function(t,e){var i=e[0],o=e[1],s=e[2];return t[12]=i*t[0]+o*t[4]+s*t[8]+t[12],t[13]=i*t[1]+o*t[5]+s*t[9]+t[13],t[14]=i*t[2]+o*t[6]+s*t[10]+t[14],t[15]=i*t[3]+o*t[7]+s*t[11]+t[15],t},t.multiplay=function(e,i,o){return o||(o=t.isGLfloat?new Float32Array(16):new Array(16)),o[0]=e[0]*i[0]+e[1]*i[4]+e[2]*i[8]+e[3]*i[12],o[1]=e[0]*i[1]+e[1]*i[5]+e[2]*i[9]+e[3]*i[13],o[2]=e[0]*i[2]+e[1]*i[6]+e[2]*i[10]+e[3]*i[14],o[3]=e[0]*i[3]+e[1]*i[7]+e[2]*i[11]+e[3]*i[15],o[4]=e[4]*i[0]+e[5]*i[4]+e[6]*i[8]+e[7]*i[12],o[5]=e[4]*i[1]+e[5]*i[5]+e[6]*i[9]+e[7]*i[13],o[6]=e[4]*i[2]+e[5]*i[6]+e[6]*i[10]+e[7]*i[14],o[7]=e[4]*i[3]+e[5]*i[7]+e[6]*i[11]+e[7]*i[15],o[8]=e[8]*i[0]+e[9]*i[4]+e[10]*i[8]+e[11]*i[12],o[9]=e[8]*i[1]+e[9]*i[5]+e[10]*i[9]+e[11]*i[13],o[10]=e[8]*i[2]+e[9]*i[6]+e[10]*i[10]+e[11]*i[14],o[11]=e[8]*i[3]+e[9]*i[7]+e[10]*i[11]+e[11]*i[15],o[12]=e[12]*i[0]+e[13]*i[4]+e[14]*i[8]+e[15]*i[12],o[13]=e[12]*i[1]+e[13]*i[5]+e[14]*i[9]+e[15]*i[13],o[14]=e[12]*i[2]+e[13]*i[6]+e[14]*i[10]+e[15]*i[14],o[15]=e[12]*i[3]+e[13]*i[7]+e[14]*i[11]+e[15]*i[15],o},t.transpse=function(e){var i=t.isGLfloat?new Float32Array(16):new Array(16);i[0]=e[0],i[1]=e[4],i[2]=e[8],i[3]=e[12],i[4]=e[1],i[5]=e[5],i[6]=e[9],i[7]=e[13],i[8]=e[2],i[9]=e[6],i[10]=e[10],i[11]=e[14],i[12]=e[3],i[13]=e[7],i[14]=e[11],i[15]=e[15],e=i},t.transpse3=function(e){var i=t.isGLfloat?new Float32Array(16):new Array(16);i[0]=e[0],i[1]=e[3],i[2]=e[6],i[3]=e[1],i[4]=e[4],i[5]=e[7],i[6]=e[2],i[7]=e[5],i[8]=e[8],e=i},t.inverse_transpose3x3from4=function(e,i){var o=e[0]*(e[5]*e[11]-e[10]*e[6])-e[1]*(e[4]*e[11]-e[6]*e[9])+e[2]*(e[4]*e[10]-e[5]*e[9]);if(0==o)return this.getInit3();var s=1/o;return i||(i=t.isGLfloat?new Float32Array(9):new Array(9)),i[0]=(e[4]*e[8]-e[7]*e[5])*s,i[1]=-(e[1]*e[8]-e[2]*e[7])*s,i[2]=(e[1]*e[5]-e[2]*e[4])*s,i[3]=-(e[3]*e[8]-e[5]*e[6])*s,i[4]=(e[0]*e[8]-e[2]*e[6])*s,i[5]=-(e[0]*e[5]-e[3]*e[2])*s,i[6]=(e[3]*e[7]-e[6]*e[4])*s,i[7]=-(e[0]*e[7]-e[6]*e[1])*s,i[8]=(e[0]*e[4]-e[3]*e[1])*s,i},e.prototype.select=function(){this.gl.useProgram(this.program)};var r=r||{};r.gameResize=function(){},r.Engine=function(){this.canvas=null,this.preview=[512,512],this.curShader="defolt",this.shaders={defolt:{}},this.shaderProgram=null,this.models={},this.textures={},this.renables=[],this.efects=[],this.camera=new r.Camera,this.lights=new r.Lights,this.tReady=0,this.onload=null,this.keysDown={},this.keysUp={};var t=this;function e(){t.canvas&&(t.preview[0]=t.canvas.viewportWidth=canvas.width,t.preview[1]=t.canvas.viewportHeight=canvas.height,r.gameResize())}e(),document.addEventListener("keydown",(function(e){t.keyPressed(e)})),document.addEventListener("keyup",(function(e){t.keyReleased(e)})),window.addEventListener("resize",e,!0)},r.Engine.prototype.constructor=r.Engine,r.Engine.prototype.onLoaded=function(t){this.onload=t,this.onloadToDo=!0},r.Engine.prototype.onKey=function(t,e,i){this.keysDown[t]=e,this.keysUp[t]=i},r.Engine.prototype.keyPressed=function(t){var e=t.keyCode;this.keysDown[e]&&this.keysDown[e](),t.ctrlKey||t.preventDefault()},r.Engine.prototype.keyReleased=function(t){var e=t.keyCode;this.keysUp[e]&&(this.keysUp[e](),t.preventDefault())},r.Engine.prototype.selectCanvas=function(t){if(this.canvas)throw"WebGL allready initialised";try{this.canvas=t.getContext("experimental-webgl",{antialias:!0}),this.canvas||(this.canvas=t.getContext("experimental-webgl")),this.canvas||(this.canvas=t.getContext("webgl")),window.dispatchEvent(new Event("resize"))}catch(t){}if(!this.canvas)throw"We could not intitialise WebGL on your browser"},r.Engine.prototype.vertexShader=function(t){if(!t)throw"no vertex shader code";if(!this.canvas)throw"select canvas first";var e=this.compileShader(this.canvas,t,this.canvas.VERTEX_SHADER);return this.shaders[this.curShader].vertex=e,e},r.Engine.prototype.fragmentShader=function(t){if(!t)throw"no vertex shader code";if(!this.canvas)throw"select canvas first";var e=this.compileShader(this.canvas,t,this.canvas.FRAGMENT_SHADER);return this.shaders[this.curShader].fragment=e,e},r.Engine.prototype.selectShader=function(t){this.curShader=t,this.shaders[this.curShader]||(this.shaders[this.curShader]={}),this.shaders[this.curShader].program&&(this.shaderProgram=this.shaders[this.curShader].program,this.shaderProgram.select())},r.Engine.prototype.compileShader=function(t,e,i){var o=t.createShader(i);if(t.shaderSource(o,e),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS))throw"could not compile shader:"+t.getShaderInfoLog(o);return o},r.Engine.prototype.initShaders=function(){var t=this.canvas;if(!t)throw"canvas not selected";if(!this.shaders[this.curShader])throw"shaders not compiled for selection "+this.curShader;if(!this.shaders[this.curShader].fragment)throw" fragment shader not compiled for selection "+this.curShader;if(!this.shaders[this.curShader].vertex)throw" vertex shader not compiled for selection "+this.curShader;var o=this.shaders[this.curShader].fragment,s=this.shaders[this.curShader].vertex;this.shaderProgram=new e(t,s,o,this.shaders[this.curShader].uniform,this.shaders[this.curShader].attribute),this.shaders[this.curShader].program=this.shaderProgram,t.uniform1i(this.shaderProgram.sampler,0),t.uniform1i(this.shaderProgram.samplerShadowMap,1),this.shaderProgram.sampler2&&t.uniform1i(this.shaderProgram.sampler2,2);var n={x:5,y:7,z:5};n=i(n),r.LIGHTDIR=[n.x,n.y,n.z],this.camera.light=n,this.camera.matCalctulate(),t.uniform3fv(this.shaderProgram.source_direction,r.LIGHTDIR),t.disable(t.DEPTH_TEST),t.enable(t.BLEND),t.clearDepth(1),t.enable(t.CULL_FACE),t.cullFace(t.BACK)},r.Engine.prototype.initShadersPackage=function(t){var o=this.canvas;if(!o)throw"canvas not selected";this.shaders[t.name]=t,this.curShader=t.name,t.program=new e(o,this.vertexShader(t.vertex),this.fragmentShader(t.fragment),t.uniform,t.attribute),this.shaderProgram=t.program,o.uniform1i(this.shaderProgram.sampler,0),o.uniform1i(this.shaderProgram.samplerShadowMap,1),this.shaderProgram.sampler2&&o.uniform1i(this.shaderProgram.sampler2,2);var s={x:5,y:7,z:5};s=i(s),r.LIGHTDIR=[s.x,s.y,s.z],this.camera.light=s,this.camera.matCalctulate(),o.uniform3fv(this.shaderProgram.source_direction,r.LIGHTDIR),o.disable(o.DEPTH_TEST),o.enable(o.BLEND),o.clearDepth(1),o.enable(o.CULL_FACE),o.cullFace(o.BACK)},r.Engine.prototype.loadTexture=function(t,e,i){var o=this.canvas,s=this;function n(t){if(!t)return null;var e=o.createTexture();return e.image=new Image,e.image.onload=function(t){o.bindTexture(o.TEXTURE_2D,e),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!0),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,e.image),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.NEAREST),o.generateMipmap(o.TEXTURE_2D),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.NEAREST_MIPMAP_LINEAR),o.bindTexture(o.TEXTURE_2D,null),s.tReady--},s.tReady++,e.image.src=t,e}s.textures[t]=new r.Texture(o,n(e),n(i))},r.Engine.prototype.loadModel=function(t,e){var i;i="string"==typeof e||e instanceof String?JSON.parse(e):e;var o=new r.Mesh(this.canvas);o.SetMesh(i.vertices,i.textcords,i.normals,i.indices),this.models[t]=i,this.models[t].mesh=o,this.canvas},r.framecount=0,r.framelast=0,r.framerate=0,r.bindTexture=0,r.bindTextureCount=0,setInterval((function(){r.framerate=r.framecount-r.framelast,r.framelast=r.framecount}),1e3),r.Engine.prototype.render=function(){var t=this;if(this.tReady<1){this.onloadToDo&&(this.onload(),this.onloadToDo=!1),r.framecount+=1;var e=this.canvas,i=this.camera,o=null;if(this.shaders.shadow){if(!this.texture_rtt){o=this.fb=e.createFramebuffer(),e.bindFramebuffer(e.FRAMEBUFFER,o);var s=this.rb=e.createRenderbuffer();e.bindRenderbuffer(e.RENDERBUFFER,s),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,1024,1024),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,s);var n=this.texture_rtt=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1024,1024,0,e.RGBA,e.UNSIGNED_BYTE,null),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0),e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null)}e.bindFramebuffer(e.FRAMEBUFFER,this.fb),this.selectShader("shadow");var a=this.shaderProgram;for(var h in e.viewport(0,0,1024,1024),e.clearColor(1,0,0,1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.uniformMatrix4fv(a.Pmatrix,!1,i.getLightProj()),e.uniformMatrix4fv(a.Lmatrix,!1,i.getLight()),this.renables)if(this.renables.hasOwnProperty(h))for(var l=this.renables[h],d=0;d<l.length;d++)l[d].Draw(a);e.bindFramebuffer(e.FRAMEBUFFER,null)}for(var h in e.clearColor(0,0,0,0),e.viewport(0,0,this.preview[0],this.preview[1]),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.enable(e.DEPTH_TEST),e.enable(e.BLEND),e.depthFunc(e.LEQUAL),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),this.renables)if(this.renables.hasOwnProperty(h)){this.selectShader(h);var c=this.renables[h];for((a=this.shaderProgram).time&&e.uniform1f(a.time,r.framecount/10),e.uniformMatrix4fv(a.Pmatrix,!1,i.getProj()),e.uniformMatrix4fv(a.Vmatrix,!1,i.getMat()),e.uniformMatrix4fv(a.PmatrixLight,!1,i.getLightProj()),e.uniformMatrix4fv(a.Lmatrix,!1,i.getLight()),a.cameraPosition&&e.uniform3fv(a.cameraPosition,i.cameraPosition()),this.texture_rtt&&(e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,this.texture_rtt)),this.lights.Draw(e,a),d=0;d<c.length;d++)c[d].Draw(a)}if(this.efects.length>0)for(this.selectShader("efects"),a=this.shaderProgram,e.uniformMatrix4fv(a.Pmatrix,!1,i.getProj()),e.uniformMatrix4fv(a.Vmatrix,!1,i.getMat()),a.cameraPosition&&e.uniform3fv(a.cameraPosition,i.cameraPosition()),e.cullFace(e.BACK),d=0;d<this.efects.length;d++)this.efects[d].Draw(a);e.flush()}window.requestAnimationFrame((function(){t.render()}))},r.Engine.prototype.getCamera=function(t,e){return this.camera},r.Engine.prototype.getObject=function(t,e,i,o,s){var n=new r.Rendable(this.canvas,this.models[e].mesh,this.textures[i],t,0,s);return o&&this.addRender(n),n},r.Engine.prototype.getAObject=function(t,e,i,o,s){for(var n=[],a=[],h=0;h<e.length;h++)n.push(this.models[e[h]].mesh);for(var l=0;l<i.length;l++)a.push(this.textures[i[l]]);var d=new r.ARendable(this.canvas,n,a,t,0,s);return o&&this.addRender(d),d},r.Engine.prototype.addRender=function(t){var e=t.shaderid;this.renables[e]||(this.renables[e]=[]),this.renables[e].push(t),this.renables[e]=this.renables[e].sort((function(t,e){return t.position.y>e.position.y?1:t.position.y<e.position.y?-1:0}))},r.Engine.prototype.getEfect=function(t,e,i,o){var s=new r.Rendable(this.canvas,this.models[e].mesh,this.textures[i],t,0);return o&&this.efects.push(s),s},r.Engine.prototype.getObjectsStatic=function(t,e,i,o,s,n){for(var a={vertices:[],textcords:[],normals:[],indices:[]},h=this.models[i],l=0;l<e.length;l++)a.vertices=a.vertices.concat(h.vertices),a.textcords=a.textcords.concat(h.textcords),a.normals=a.normals.concat(h.normals),a.indices=a.indices.concat(h.indices);for(l=0;l<e.length;l++){for(var d=0;d<h.indices.length;d++)a.indices[l*h.indices.length+d]+=l*h.vertices.length/3;for(d=0;d<h.vertices.length;d++)a.vertices[l*h.vertices.length+d]=d%3==0?parseFloat(a.vertices[l*h.vertices.length+d])+e[l].x:d%3==1?parseFloat(a.vertices[l*h.vertices.length+d])+e[l].y:parseFloat(a.vertices[l*h.vertices.length+d])+e[l].z}var c=new r.Mesh(this.canvas);c.SetMesh(a.vertices,a.textcords,a.normals,a.indices);var p=new r.Rendable(this.canvas,c,this.textures[o],t,0,n);return s&&this.addRender(p),p},r.Engine.prototype.remObject=function(t){for(var e in this.renables)this.renables.hasOwnProperty(e)&&(this.renables[e]=this.renables[e].filter((function(e){return e!=t})));this.efects=this.efects.filter((function(e){return e!=t}))},r.Lights=function(){this.lights=t.isGLfloat?new Float32Array(35):new Array(35),this.last=0},r.Lights.prototype.Draw=function(t,e){e.Flights&&t.uniform1fv(e.Flights,this.lights)},r.Lights.prototype.clear=function(){this.last=0;for(var t=0;t<35;t++)this.lights[t]=0},r.Lights.prototype.addLight=function(t,e,i){var o=this.last%6*7;return this.lights[o]=t[0],this.lights[o+1]=t[1],this.lights[o+2]=t[2],this.lights[o+3]=e.x,this.lights[o+4]=e.y,this.lights[o+5]=e.z,this.lights[o+6]=i,this.last+=1,e},r.Loader=function(t){this.urls={},this.toGet=[],this.loaded=0,this.engine=t},r.Loader.prototype.constructor=r.Loader,r.Loader.prototype.add=function(t,e,i){this.toGet.push(t),this.urls[t]={url:e,data:"",model:i}},r.Loader.prototype.loadModels=function(t){for(var e in t)t.hasOwnProperty(e)&&t[e].model&&this.engine.loadModel(e,t[e].data)},r.Loader.prototype.load=function(){var t=this,e=this.urls;!function i(){if(t.toGet.length<=0)return t.loadModels(e),void t.callback(e);var o=e[t.toGet.pop()],s=new XMLHttpRequest;s.open("get",o.url,!0),s.onload=function(){200==s.status?o.data=s.response:console.error("not loaded: "+o.url),t.loaded+=1,i()},s.send()}()},r.Loader.prototype.onLoad=function(t){this.callback=t},r.Loader.prototype.onError=function(){},r.Mesh=function(t){this.gl=t,this.id=Math.random()},r.Mesh.prototype.constructor=r.Mesh,r.lastMesh=0,r.lastShader=0,r.Mesh.prototype.Draw=function(t){var e=this.gl;r.lastMesh==this.id&&r.lastShader==t||(r.lastMesh=this.id,r.lastShader=t,t.position>=0&&(e.bindBuffer(e.ARRAY_BUFFER,this.vertex_buffer),e.vertexAttribPointer(t.position,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(t.position)),t.uv>=0&&(e.bindBuffer(e.ARRAY_BUFFER,this.texcords_buffer),e.vertexAttribPointer(t.uv,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(t.uv)),t.normal>=0&&(e.bindBuffer(e.ARRAY_BUFFER,this.normals_buffer),e.vertexAttribPointer(t.normal,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(t.normal)),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.index_buffer)),e.drawElements(e.TRIANGLES,this.index_buffer.len,e.UNSIGNED_SHORT,0)},r.Mesh.prototype.SetMesh=function(t,e,i,o){var s=this.gl,n=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,n),s.bufferData(s.ARRAY_BUFFER,new Float32Array(t),s.STATIC_DRAW),this.vertex_buffer=n;var r=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,r),s.bufferData(s.ARRAY_BUFFER,new Float32Array(e),s.STATIC_DRAW),this.texcords_buffer=r;var a=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,a),s.bufferData(s.ARRAY_BUFFER,new Float32Array(i),s.STATIC_DRAW),this.normals_buffer=a;var h=s.createBuffer();s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,h),s.bufferData(s.ELEMENT_ARRAY_BUFFER,new Uint16Array(o),s.STATIC_DRAW),this.index_buffer=h,this.index_buffer.len=o.length},r.Mesh.prototype.SetColors=function(t){this.gl},r.Mesh.prototype.SetTextureCords=function(t){var e=this.gl;return this.triangleVertexTextureCoordBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.triangleVertexTextureCoordBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(t),e.STATIC_DRAW),this.triangleVertexTextureCoordBuffer.itemSize=2,this.triangleVertexTextureCoordBuffer.numItems=t.length/2,this.triangleVertexTextureCoordBuffer},r.Texture=function(t,e,i){this.gl=t,this.texture=e,this.lastTexture=e,this.texture2=i},r.Texture.prototype.constructor=r.Texture,r.Texture.prototype.Draw=function(t){var e=this.gl;r.lastTexture===this.texture&&r.lastShader!=t||(e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this.texture),r.lastTexture=this.texture),r.lastTexture2===this.texture2&&r.lastShader!=t||(e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,this.texture2),r.lastTexture2=this.texture2)},r.ATexture=function(t,e){this.gl=t,this.texture=e,this.numModel=model.length,this.numText=e.length,this.curText=0},r.ATexture.prototype.constructor=r.ATexture,r.ATexture.prototype.Draw=function(t){var e=this.gl;this.lastTexture=this.texture[this.curText%this.numText],r.lastTexture==this.lastTexture&&r.lastShader!=t||(e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this.lastTexture),r.lastTexture=this.lastTexture)},r.NTexture=function(t,e,i){this.gl=t,this.texture=e,this.number=i},r.NTexture.prototype.constructor=r.NTexture,r.NTexture.prototype.Draw=function(t){var e=this.gl;this.lastTexture=this.texture,r.lastTexture==this.lastTexture&&r.lastShader!=t||(e.activeTexture(e["TEXTURE"+this.number]),e.bindTexture(e.TEXTURE_2D,this.lastTexture))},r.Camera=function(){this.position={x:5,y:5,z:5},this.target={x:0,y:0,z:0},this.up={x:0,y:1,z:0},this.mat=t.getInit(),this.proj_matrix=t.orthogonal(5,1,1,100),this.light_proj_matrix=t.orthogonal(512,1,-256,256),this.light_mat=t.getInit(),this.light={x:1,y:1,z:1},this.perspective=!1,this.fov=1},r.Camera.prototype.constructor=r.Camera,r.Camera.prototype.SetPosition=function(t,e,i){this.x=t,this.y=e,this.z=i},r.Camera.prototype.SetTarget=function(t,e,i){this.tx=t,this.ty=e,this.tz=i},r.Camera.prototype.matCalctulate=function(){var t=i(n(this.target,this.position)),e=i(this.up),r=i(s(t,e));e=s(r,t),this.mat[0]=r.x,this.mat[4]=r.y,this.mat[8]=r.z,this.mat[1]=e.x,this.mat[5]=e.y,this.mat[9]=e.z,this.mat[2]=-t.x,this.mat[6]=-t.y,this.mat[10]=-t.z,this.mat[12]=-o(r,this.position),this.mat[13]=-o(e,this.position),this.mat[14]=o(t,this.position);var a={x:this.light.x+this.target.x,y:this.light.y+this.target.y,z:this.light.z+this.target.z};return t=i(n(this.target,a)),e=i({x:0,y:1,z:0}),r=i(s(t,e)),e=s(r,t),this.light_mat[0]=r.x,this.light_mat[4]=r.y,this.light_mat[8]=r.z,this.light_mat[1]=e.x,this.light_mat[5]=e.y,this.light_mat[9]=e.z,this.light_mat[2]=-t.x,this.light_mat[6]=-t.y,this.light_mat[10]=-t.z,this.light_mat[12]=-o(r,a),this.light_mat[13]=-o(e,a),this.light_mat[14]=o(t,a),this.mat},r.Camera.prototype.getMat=function(){return this.mat},r.Camera.prototype.lookAt=function(t,e,i,o,s,n,r,a,h){return this.position={x:t,y:e,z:i},this.target={x:o,y:s,z:n},this.up={x:r,y:a,z:h},this.matCalctulate()},r.Camera.prototype.getLight=function(){return this.light_mat},r.Camera.prototype.setLightDirection=function(t,e,i){this.light={x:t,y:e,z:i}},r.Camera.prototype.getLightProj=function(){return this.light_proj_matrix},r.Camera.prototype.setLightProj=function(e,i,o,s){this.light_proj_matrix=t.orthogonal(e,i,o,s)},r.Camera.prototype.calcProjection=function(){return this.perspective?this.proj_matrix=t.perspective(this.fov,this.width/this.height,this.near,this.far):this.proj_matrix=t.orthogonal(this.fov,this.width/this.height,this.near,this.far),this.proj_matrix},r.Camera.prototype.setProjection=function(t,e,i,o,s,n){return this.perspective=n,this.fov=t,this.width=e,this.height=i,this.near=o,this.far=s,this.calcProjection(),this.proj_matrix},r.Camera.prototype.getProj=function(){return this.proj_matrix},r.Camera.prototype.cameraPosition=function(){return[this.position.x,this.position.y,this.position.z]},r.Rendable=function(e,i,o,s,n,r){this.gl=e,this.model=i,this.texture=o,this.position=s,this.rotation=n,this.shaderid=r||"defolt",this.size=1,this.checks=this.size+n+s.x>>1+s.y>>2+s.z>>3,this.mov_matrix=[this.size,0,0,0,0,this.size,0,0,0,0,this.size,0,this.position.x,this.position.y,this.position.z,1],this.mov_matrix=t.rotate(this.mov_matrix,this.rotation,[0,1,0]),this.inv_trans=t.inverse_transpose3x3from4(this.mov_matrix)},r.Rendable.prototype.constructor=r.Rendable,r.lastModel=[],r.Rendable.prototype.Draw=function(e){var i=this.gl;this.checks!=this.size+this.rotation+this.position.x+2.57*this.position.y+3.22*this.position.z&&(this.checks=this.size+this.rotation+this.position.x+2.57*this.position.y+3.22*this.position.z,this.mov_matrix=[this.size,0,0,0,0,this.size,0,0,0,0,this.size,0,this.position.x,this.position.y,this.position.z,1],0!=this.rotation&&(this.mov_matrix=t.rotatef(this.mov_matrix,this.rotation,[0,1,0])),e.inv_trans&&t.inverse_transpose3x3from4(this.mov_matrix,this.inv_trans)),i.uniformMatrix4fv(e.Mmatrix,!1,this.mov_matrix),e.inv_trans&&i.uniformMatrix3fv(e.inv_trans,!1,this.inv_trans),this.texture.Draw(e),this.model.Draw(e)},r.Rendable.prototype.Draw1=function(e){var i=this.gl;this.checks!=.255*this.size.x+.689*this.size.y+.245*this.size.z+this.rotation+this.position.x+2.57*this.position.y+3.22*this.position.z&&(this.checks=.255*this.size.x+.689*this.size.y+.245*this.size.z+this.rotation+this.position.x+2.57*this.position.y+3.22*this.position.z,this.mov_matrix=[this.size.x,0,0,0,0,this.size.y,0,0,0,0,this.size.z,0,this.position.x,this.position.y,this.position.z,1],0!=this.rotation&&(this.mov_matrix=t.rotatef(this.mov_matrix,this.rotation,[0,1,0])),e.inv_trans&&t.inverse_transpose3x3from4(this.mov_matrix,this.inv_trans)),i.uniformMatrix4fv(e.Mmatrix,!1,this.mov_matrix),e.inv_trans&&i.uniformMatrix3fv(e.inv_trans,!1,this.inv_trans),this.texture.Draw(e),this.model.Draw(e)},r.ARendable=function(e,i,o,s,n,r){this.gl=e,this.model=i,this.texture=o,this.numModel=i.length,this.numText=o.length,this.curModel=0,this.curText=0,this.shaderid=r||"defolt",this.position=s,this.rotation=n,this.size=1,this.checks=this.size+n+s.x>>1+s.y>>2+s.z>>3,this.mov_matrix=[this.size,0,0,0,0,this.size,0,0,0,0,this.size,0,this.position.x,this.position.y,this.position.z,1],this.mov_matrix=t.rotate(this.mov_matrix,this.rotation,[0,1,0]),this.inv_trans=t.inverse_transpose3x3from4(this.mov_matrix)},r.ARendable.prototype.constructor=r.ARendable,r.ARendable.prototype.Draw=function(e){var i=this.gl;this.checks!=this.size+this.rotation+this.position.x+2.57*this.position.y+3.22*this.position.z&&(this.checks=this.size+this.rotation+this.position.x+2.57*this.position.y+3.22*this.position.z,this.mov_matrix=[this.size,0,0,0,0,this.size,0,0,0,0,this.size,0,this.position.x,this.position.y,this.position.z,1],0!=this.rotation&&(this.mov_matrix=t.rotatef(this.mov_matrix,this.rotation,[0,1,0])),e.inv_trans&&t.inverse_transpose3x3from4(this.mov_matrix,this.inv_trans)),i.uniformMatrix4fv(e.Mmatrix,!1,this.mov_matrix),e.inv_trans>=0&&i.uniformMatrix3fv(e.inv_trans,!1,this.inv_trans),this.lastTexture=this.texture[this.curText%this.numText],this.lastTexture.Draw(e),this.model[this.curModel%this.numModel].Draw(e)};var a=function(){};function h(t,e,i){return Math.abs(t.x-e.x)<i&&Math.abs(t.z-e.z)<i?1:0}function l(t,e){var i=t-e,o=t-e+2*Math.PI,s=t-e-2*Math.PI;return Math.abs(i)>Math.abs(o)&&(i=o),Math.abs(i)>Math.abs(s)&&(i=s),i}function d(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.z-e.z)*(t.z-e.z))}function c(t,e){this.sound=t,this.player=e,this.sounds=[]}function p(t,e,i){var o=t;i&&o.numText&&(o.curText=i.team),m.call(this,t,e),this.dest={x:o.position.x,y:o.position.y,z:o.position.z},this.stable={x:o.position.x,y:o.position.y,z:o.position.z},this.speed=20,this.turn_speed=10,this.driver=i,this.size=2,this.helth=20,this.pose=0}function u(t,e){this.model=t,this.controler=e,this.helthMax=10,this.helth=10,t.size*=.8,this.size=20*t.size}function m(t,e){u.call(this,t,e),this.dest={x:t.position.x,y:t.position.y,z:t.position.z},this.stable={x:t.position.x,y:t.position.y,z:t.position.z},this.speed=25,this.turn_speed=6,this.driver=null,this.helthMax=5*this.size,this.helth=this.helthMax}function x(t,e){m.call(this,t,e),this.dest={x:t.position.x,y:t.position.y,z:t.position.z},this.stable={x:t.position.x,y:t.position.y,z:t.position.z},this.upgrade=[0,0,0,0],this.speed=30,this.turn_speed=8,this.driver=null,this.helth=100,this.shootTimeOut=1,this.shootSpeed=2}function y(t,e){x.call(this,t,e),this.upgrade=[0,0,0,0],this.speed=35,this.turn_speed=10,this.driver=null,this.helth=4*this.size,this.helthMax=80,this.shootTimeOut=2,this.shootSpeed=.1}function f(t,e,i){m.call(this,t,i),this.model1=e,this.dest={x:t.position.x,y:t.position.y,z:t.position.z},this.stable={x:t.position.x,y:t.position.y,z:t.position.z},this.upgrade=[0,0,0,0],this.speed=40,this.turn_speed=5,this.driver=null,this.helthMax=3*this.size,this.helth=this.helthMax,this.shootTimeOut=2,this.elise_speed=0,this.flyHeight=17,this.shootSpeed=.65}function v(t){this.team=t,this.shield=1,this.oldControl={a:0,w:0,s:0,d:0,e:0,f:0},this.oldStable={x:-1,y:-1,z:-1},this.vehicleOldPosition={x:-1,y:-1,z:-1}}a.init=function(){if("undefined"!=typeof AudioContext)a.context=new AudioContext;else{if("undefined"==typeof webkitAudioContext)throw new Error("AudioContext not supported. :(");a.context=new webkitAudioContext}(a.svolume=a.context.createGain()).connect(a.context.destination),a.svolume.gain.value=.9,a.loaded={},a.buffers={}},a.requestSound=function(t,e){var i=new XMLHttpRequest;return i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=function(){var o=i.response;a.createSoundSource(o,e,t)},i.send(),{play:function(){a.playSound(t)}}},a.finishedLoading=function(t){a.loaded=t},a.playSound=function(t,e){if(a.loaded[t]){var i=a.context.createGain();i.gain.value=e,i.connect(a.svolume);var o=a.context.createBufferSource();o.buffer=a.loaded[t],o.connect(i),o.start(a.context.currentTime);var s={s:o,v:i,end:!1};return o.onended=function(){s.end=!0},s}},a.createSoundSource=function(t,e,i){a.context.decodeAudioData(t,(function(t){a.loaded[i]=t}))},c.prototype.playSound=function(t,e){if(!(d(this.player.lastPos,t)>200)){var i=this.sound.playSound(e,this.processVoume(t));i.p=t,this.sounds.push(i)}},c.prototype.update=function(){var t=this;this.sounds=this.sounds.filter((function(e){return e.end?(e.s.disconnect(),e.v.disconnect(),!1):(e.v.gain.value=t.processVoume(e.p),!0)}))},c.prototype.processVoume=function(t){var e=d(this.player.lastPos,t);return e<20?1:(e=20/e,!isNaN(parseFloat(e))&&isFinite(e)&&e>0?e:0)},p.prototype=Object.create(u.prototype),p.prototype.update=function(t,e){var i=this.speed,o=this.model,s=this.driver.getInstructions(this,e),n=-s.a+s.d,r=-s.s+s.w,a=Math.atan2(n,r);if(this.pose+=6*t,0!=n||0!=r)if(o.curModel=Math.floor(this.pose),Math.abs(l(o.rotation,a))>this.turn_speed*t)this.turn(t,a);else{o.rotation=a;var h={x:o.position.x+Math.sin(o.rotation)*i*t,y:e.getYDisp(o.position),z:o.position.z+Math.cos(o.rotation)*i*t};this.validNewPostion(h,e)&&(o.position=h)}},p.prototype.validNewPostion=function(t,e){var i=this,o=e.free(t,this.size);o.coliders=o.coliders.filter((function(t){return i!=t&&Math.abs(i.model.position.y-t.model.position.y)<10}));var s=[],n=[];return o.coliders.forEach((function(t){t instanceof m&&(t.driver?n.push(t):s.push(t))}),this),s.length>0&&(this.valid=!1,s[0].setDriver(this.driver)),n.length>0&&this.demage({owner:n[0].driver,value:1},2,e),0==o.map&&0==o.coliders.length},p.prototype.processPickables=function(t){},p.prototype.setDriver=function(t){this.driver=t,this.model.numText&&(this.model.curText=t.team)},p.prototype.turn=function(t,e){var i=this.model;l(i.rotation,e)>0?i.rotation-=this.turn_speed*t:i.rotation+=this.turn_speed*t,i.rotation>Math.PI&&(i.rotation-=2*Math.PI),i.rotation<-Math.PI&&(i.rotation+=2*Math.PI)},p.prototype.move=function(t,e){this.dest.x==this.model.position.x&&this.dest.z==this.model.position.z&&(this.stable={x:this.model.position.x,y:this.model.position.y,z:this.model.position.z},this.dest.x=this.model.position.x+t,this.dest.z=this.model.position.z+e,this.dest.angle=null)},p.prototype.moveToword=function(t,e){0==t&&0==e||(Math.atan2(t,e)==this.model.rotation&&this.dest.x==this.model.position.x&&this.dest.z==this.model.position.z?(this.stable={x:this.model.position.x,y:this.model.position.y,z:this.model.position.z},this.dest.x=this.model.position.x+t,this.dest.z=this.model.position.z+e,this.dest.angle=Math.atan2(t,e)):this.dest.x==this.model.position.x&&this.dest.z==this.model.position.z&&(this.dest.angle=Math.atan2(t,e)))},p.prototype.shoot=function(){},p.prototype.exit=function(){},p.prototype.demage=function(t,e,i){if(e<this.size/2&&(e=this.size/2),this.helth-=t.value/e*3,this.helth<0&&this.valid){this.valid=!1,this.controler.makeBloodStain(this.model.position),this.driver&&t.owner.killed(this.driver);var o=Math.floor(10*Math.random());o<4&&this.controler.createPickable(this,o,10,10)}},u.prototype.update=function(){},u.prototype.demage=function(t,e,i){if(e<this.size&&(e=this.size),this.driver&&this.driver.shield&&(t.value=10/(9+this.driver.shield)*t.value),this.helth-=t.value/e*this.size/2,this.helthBar||this.controler.createBarr(this),this.helth<0&&this.valid){if(this.valid=!1,this.driver&&t.owner.killed(this.driver),i){var o=this;setTimeout((function(){for(var e=i.free(o.model.position,2*o.size),s=0;s<e.coliders.length;s++){var n=e.coliders[s];n.demage({value:5*o.size,owner:t.owner},d(n.model.position,o.model.position),i)}}),200)}this.controler.createExplosion(this,1.5);var s=Math.floor(20*Math.random());s<4&&this.controler.createPickable(this,s,10,10)}},m.prototype=Object.create(u.prototype),m.prototype.setDriver=function(t){this.model.numText&&(this.model.curText=t.team+1),this.driver=t},m.prototype.runPickables=function(t){var e=this.speed;this.upgrade[0]>0&&(e*=1.25),this.upgrade[1]>0&&(this.shootTimeOut-=t),this.upgrade[2]>0&&(this.helth=this.helthMax,this.upgrade[2]=0),this.upgrade[3]>0&&(this.helth=this.helthMax);for(var i=0;i<this.upgrade.length;i++)this.upgrade[i]-=t;return e},m.prototype.validNewPostion=function(t,e,i){i||(i=1);var o=this,s=e.free(t,this.size-1);s.coliders=s.coliders.filter((function(t){return o!=t&&!(t instanceof p)&&Math.abs(o.model.position.y-t.model.position.y)<o.size/2})),s.pickables.length>0&&this.processPickables(s.pickables);var n=s.map<i&&0==s.coliders.length;return n||(this.exitVehicle=!1),n},m.prototype.processPickables=function(t){for(var e=0;e<t.length;e++)this.upgrade[t[e].type]=t[e].duration,t[e].valid=!1},m.prototype.update=function(t,e){},m.prototype.corectPostition=function(t,e,i){var o=this.model;if(h(this.stable,o.position,8)){var s={x:o.position.x,y:o.position.y,z:o.position.z};if(Math.abs(Math.sin(o.rotation))<Math.abs(Math.cos(o.rotation))){var n=this.stable.x-s.x,r=Math.abs(n);r>e*this.speed/2?(n/=r/this.speed*2,s.x+=n*e):s.x=this.stable.x}else{var a=this.stable.z-s.z,l=Math.abs(a);l>e*this.speed/2?(a/=l/this.speed*2,s.z+=a*e):s.z=this.stable.z}this.validNewPostion(s,t)&&this.newPosition(s,i)}},m.prototype.newPosition=function(t,e){this.model.position=t,this.stable={x:20*((t.x+10)/20<<0),y:t.y,z:20*((t.z+10)/20<<0)}},m.prototype.turn=function(t,e){var i=this.model;l(i.rotation,e)>0?i.rotation-=this.turn_speed*t:i.rotation+=this.turn_speed*t,i.rotation>Math.PI&&(i.rotation-=2*Math.PI),i.rotation<-Math.PI&&(i.rotation+=2*Math.PI)},m.prototype.move=function(t,e){this.dest.x==this.model.position.x&&this.dest.z==this.model.position.z&&(this.stable={x:this.model.position.x,y:this.model.position.y,z:this.model.position.z},this.dest.x=this.model.position.x+t,this.dest.z=this.model.position.z+e,this.dest.angle=null)},m.prototype.moveToword=function(t,e){0==t&&0==e||(Math.atan2(t,e)==this.model.rotation&&this.dest.x==this.model.position.x&&this.dest.z==this.model.position.z?(this.stable={x:this.model.position.x,y:this.model.position.y,z:this.model.position.z},this.dest.x=this.model.position.x+t,this.dest.z=this.model.position.z+e,this.dest.angle=Math.atan2(t,e)):this.dest.x==this.model.position.x&&this.dest.z==this.model.position.z&&(this.dest.angle=Math.atan2(t,e)))},m.prototype.shoot=function(){},m.prototype.exit=function(){this.exitVehicle=!0},x.prototype=Object.create(m.prototype),x.prototype.update=function(t,e){if(this.driver&&this.controler.sceneScope(this.model.position)){this.shootTimeOut-=t;var i=this.runPickables(t),o=this.driver.getInstructions(this,e);o.e&&(this.exitVehicle=!0),o.f&&this.shoot();var s=this.model;if(this.exitVehicle){var n={x:s.position.x+Math.sin(s.rotation+Math.PI)*this.size*.65,y:e.getYDisp(s.position),z:s.position.z+Math.cos(s.rotation+Math.PI)*this.size*.65},r=e.free(n,2);if(0==r.map&&0==r.coliders.length)return this.controler.exit(n,this.driver),this.driver=null,void(this.exitVehicle=!1)}var a=-o.a+o.d,h=-o.s+o.w,d=Math.atan2(a,h);if(0!=a||0!=h)if(Math.abs(l(s.rotation,d))>this.turn_speed*t)this.turn(t,d);else{s.rotation=d;var c={x:s.position.x+Math.sin(s.rotation)*i*t,y:e.getYDisp(s.position),z:s.position.z+Math.cos(s.rotation)*i*t};this.validNewPostion(c,e)?(s.position=c,this.stable={x:20*((c.x+10)/20<<0),y:c.y,z:20*((c.z+10)/20<<0)}):this.corectPostition(e,t)}}},x.prototype.shoot=function(){this.shootTimeOut<0&&(this.shootTimeOut=this.shootSpeed,this.controler.shoot(this,this.size/2.15,this.model.rotation+.1*Math.random()-.05,80,115+10*Math.random(),45))},y.prototype=Object.create(x.prototype),y.prototype.shoot=function(){this.shootTimeOut<0&&(this.shootTimeOut=this.shootSpeed,this.controler.shootB(this,this.size/2.5,this.model.rotation+.2*Math.random()-.1,85+5*Math.random(),5))},f.prototype=Object.create(m.prototype),f.prototype.flyUp=function(t,e){if(this.driver){var i=e-this.model.position.y;Math.abs(i)>.5?(i>0&&this.elise_speed>1&&(this.model.position.y+=5*t),i<0&&(this.model.position.y-=5*t)):this.model.position.y=e}this.driver?(this.elise_speed+=.5*t,this.elise_speed>2&&(this.elise_speed=2)):(this.elise_speed-=.5*t,this.elise_speed<0&&(this.elise_speed=0)),this.model1.numText&&(this.model1.curText=this.elise_speed>.5?1:0),this.model1.rotation+=this.elise_speed,this.model1.position.y=this.model.position.y+7},f.prototype.update=function(t,e){if(this.controler.sceneScope(this.model.position)){this.shootTimeOut-=t;var i=this.runPickables(t),o=this.driver?this.driver.getInstructions(this,e):{a:0,w:0,s:0,d:0,e:0,f:0},s=this.model;o.e&&(this.exitVehicle=!0),o.f&&this.shoot(),s=this.model;var n=e.getYDisp(this.model.position),r=(n+e.getYDisp({x:s.position.x+20*Math.sin(x),y:s.position.y,z:s.position.z+20*Math.cos(x)}))/2,a=r+this.flyHeight,h=e.getYDisp(this.model.position)-this.model.position.y,d=this.exitVehicle?n:a;if(this.validNewPostion({x:s.position.x,y:d,z:s.position.z},e,2)?this.flyUp(t,d):this.flyUp(t,s.position.y+1),this.exitVehicle&&Math.abs(h)<.5){var c={x:s.position.x+Math.sin(s.rotation+Math.PI)*this.size*.65,y:e.getYDisp(s.position),z:s.position.z+Math.cos(s.rotation+Math.PI)*this.size*.65},p=e.free(c,2);if(0==p.map&&0==p.coliders.length)return this.controler.exit(c,this.driver),this.driver=null,void(this.exitVehicle=!1);this.exitVehicle=!1}var u=-o.a+o.d,m=-o.s+o.w,x=Math.atan2(u,m);if(0!=u||0!=m)if(Math.abs(l(s.rotation,x))>this.turn_speed*t)this.model.position.y-r>this.flyHeight/3&&this.turn(t,x);else{s.rotation=x;var y={x:s.position.x+Math.sin(s.rotation)*i*t,y:s.position.y,z:s.position.z+Math.cos(s.rotation)*i*t};this.validNewPostion(y,e,2)?this.newPosition(y,r):this.corectPostition(e,t,r)}}},f.prototype.newPosition=function(t,e){this.model.position.y-e>this.flyHeight/2&&(this.model.position=t,this.model1.position.x=t.x,this.model1.position.z=t.z,this.stable={x:20*((t.x+10)/20<<0),y:t.y,z:20*((t.z+10)/20<<0)})},f.prototype.shoot=function(){this.shootTimeOut<0&&(this.shootTimeOut=this.shootSpeed,this.controler.shoot(this,0,this.model.rotation+.1*Math.random()-.05,100,80+10*Math.random(),45))},v.prototype.update=function(t,e){e.teamMembers[this.team]+=1},v.prototype.killed=function(t){t.team==this.team?this.shield-=1:this.shield+=1,this.shield<1&&(this.shield=1)},v.prototype.getInstructions=function(t,e){var i=this.oldControl;if(i.f=0,i.e=0,(this.oldStable.x!=t.stable.x||this.oldStable.z!=t.stable.z)&&h(t.stable,t.model.position,5)||t.model.position.x==this.vehicleOldPosition.x&&t.model.position.z==this.vehicleOldPosition.z&&t.model.rotation==this.vehicleOldPosition.y){this.oldStable.x=t.stable.x,this.oldStable.z=t.stable.z,e.teamMembers[this.team]+=1;for(var o=9999999,s=-1,n=0,r=0,a=0;a<4;a++){n=a%2*(a-2),r=(a+1)%2*(a-1);var l=e.free({x:t.model.position.x+40*n,y:t.model.position.y,z:t.model.position.z+40*r},5),c=e.free({x:t.model.position.x+60*n,y:t.model.position.y,z:t.model.position.z+60*r},5),u=e.free({x:t.model.position.x+80*n,y:t.model.position.y,z:t.model.position.z+80*r},5);l.coliders.concat(c.coliders).concat(u.coliders).forEach((function(e){if(e.driver&&e.driver.team!=t.driver.team){var i=d(e.model.position,t.model.position);o>i&&(o=i,s=a)}}))}var m=Math.floor(12*Math.random()),x=m%2*(m-2)*20,y=(m+1)%2*(m-1)*20;s<0?(n=Math.sin(t.model.rotation),r=Math.cos(t.model.rotation)):(n=s%2*(s-2),r=(s+1)%2*(s-1)),m>3&&(x=20*(n<<0),y=20*(r<<0));var f=e.free({x:t.model.position.x+x,y:t.model.position.y,z:t.model.position.z+y},t.size);f.coliders=f.coliders.filter((function(e){return e!=t&&!(e instanceof p&&e.driver.team!=t.driver.team)})),f.map<2&&0==f.coliders.length&&(i.a=x<0?1:0,i.d=x>0?1:0,i.s=y<0?1:0,i.w=y>0?1:0)}if(t.shootTimeOut<0){n=Math.sin(t.model.rotation),r=Math.cos(t.model.rotation);var v=0,g=0;Math.abs(n)>=1||Math.abs(r);var z=e.free({x:t.model.position.x+20*n,y:t.model.position.y,z:t.model.position.z+20*r},10),b=e.free({x:t.model.position.x+40*n,y:t.model.position.y,z:t.model.position.z+40*r},10);l=e.free({x:t.model.position.x+60*n,y:t.model.position.y,z:t.model.position.z+60*r},10),c=e.free({x:t.model.position.x+90*n,y:t.model.position.y,z:t.model.position.z+90*r},10),(u=e.free({x:t.model.position.x+110*n,y:t.model.position.y,z:t.model.position.z+110*r},10)).coliders.filter((function(e){return!(!e.driver||e.driver.team!=t.driver.team||e==t)})),u=u.coliders.forEach((function(e){e.driver&&e.driver.team!=t.driver.team&&(g=1),e.driver&&e.driver.team==t.driver.team&&(v=1)})),c=c.coliders.forEach((function(e){e.driver&&e.driver.team!=t.driver.team&&(g=2),e.driver&&e.driver.team==t.driver.team&&(v=2)})),l=l.coliders.forEach((function(e){e.driver&&e.driver.team!=t.driver.team&&(g=3),e.driver&&e.driver.team==t.driver.team&&(v=3)})),b.coliders.forEach((function(e){e.driver&&e.driver.team!=t.driver.team&&(g=4),e.driver&&e.driver.team==t.driver.team&&e!=t&&(v=4)})),z.coliders.forEach((function(e){e.driver&&e.driver.team==t.driver.team&&e!=t&&(v=5)})),g>v&&(i.f=1),i.f||(t.shootTimeOut=.5)}return t.helth<20&&(i.e=1),this.oldControl=i,this.vehicleOldPosition.x=t.model.position.x,this.vehicleOldPosition.z=t.model.position.z,this.vehicleOldPosition.y=t.model.rotation,i};var g=null;function z(t){return g||(this.team=t,this.toword={x:0,y:0},this.lastPos={x:0,y:0,z:0},this.exit=!1,this.pasive=0,this.shield=1,g=this,this)}function b(t){this.team=t,this.envioerment={actors:null,map:null},this.toword={x:0,y:0},this.lastPos={x:0,y:0,z:0},this.exit=!1,this.pasive=0,this.shield=1,this.evry=0}function w(t){this.map=t,this.coliders=[],this.pickables=[],this.teamMembers=[0,0,0,0]}function T(){this.clear(),this.tMesh=0,this.tTex=1,this.itemNum=0}function _(t,e){this.engine=t,this.units=[],this.unitRelease=[],this.objects=[],this.oldx=-1,this.oldy=-1,this.curType=0,this.setUnits=!1,this.legend=e,this.chunkSize=6,this.nChunks=3}function M(t,e,i){this.engine=t,this.controler=e,this.physics=i,this.patern={}}function P(t){switch(t){case"Choper":return f;case"Tank":return x;case"TankGun":return y;case"Truper":return p;case"PhysicalObject":return u;case"Enemy":return v;case"Player":return z}}function E(t,e,i){this.physics=t,this.controler=e,this.vehicleControler=i,this.units={},this.onHold=[]}function R(t,e,i,o){this.model=o,this.type=t,this.duration=i,this.helth=e,this.size=10}function S(t,e,i,o,s,n,r){this.typeNum=0,this.model=e,this.model1=i,this.speed=o,this.range=s,this.dmg=n,this.owner=r,this.shooter=t,this.light=[2,1.5,1.5],this.lightsize=30}function A(t,e,i,o,s){this.typeNum=0,this.model=e,this.range=i,this.dmg=o,this.owner=s,this.shooter=t,this.calculated=!0,this.anim=.2,this.light=[2,1.5,1.5],this.lightsize=20,this.rotation=this.model.rotation-Math.PI,this.position={x:this.shooter.model.position.x,y:this.shooter.model.position.y,z:this.shooter.model.position.z}}function D(t,e,i){this.typeNum=1,this.owner=t,this.model=e,this.model1=i,t.helthBar=!0,e.size={x:.1,y:.1,z:.1},i.size={x:.1,y:.1,z:.1},e.Draw=e.Draw1,i.Draw=i.Draw1,this.plusY=.75*this.owner.size}function k(t,e,i){this.typeNum=2,this.model=e,this.size=t,i||(this.size*=2),this.isSphere=i,this.grow=5,i||(this.grow=10),e.size=.1,this.light=[1,1,1],this.lightsize=.1}function L(t,e,i){this.engine=t,this.temps=[],this.physics=e,this.latetems=[],this.sound=i,this.player=new b(0)}function F(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))}function C(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function I(t,e,i,o){return o?{x:(e.x-t.x+(o.x-i.x))/2,y:(e.y-t.y+(o.y-i.y))/2}:{x:e.x-t.x,y:e.y-t.y}}function U(t,e,i,o){if(!o)return 1;if(!i)return 1;let s=F(t,i),n=F(e,o);return s<.01?1:n/s}function O(t,e,i,o){if(!o)return 0;let s=N(t,i);return N(e,o)-s}function N(t,e){let i=I(t,e);return Math.atan2(i.y,i.x)}function B(t,e){this.deadzone=e,this.clear();let i=null,o=null,s=null,n=null,r=0,a=!0,h=!1,l=!1;this.centerPosition={x:0,y:0},this.debug=!1,this.console_error=!1,this.throw_error=!1,this.last_error="";const d=t=>{t.preventDefault();const{top:e,left:i}=t.target.getBoundingClientRect();if(t.touches[1]&&t.touches[0]){let o={x:t.touches[0].clientX-i,y:t.touches[0].clientY-e},s={x:t.touches[1].clientX-i,y:t.touches[1].clientY-e};return this.centerPosition={x:(o.x+s.x)/2,y:(o.y+s.y)/2},p(o,s)}if(t.touches[0]){let o={x:t.touches[0].clientX-i,y:t.touches[0].clientY-e};return this.centerPosition={x:o.x,y:o.y},p(o)}},c=t=>{t.preventDefault();const{top:e,left:i}=t.target.getBoundingClientRect();this.centerPosition={x:t.clientX-i,y:t.clientY-e},r&&p({x:t.clientX-i,y:t.clientY-e})},p=(t,e)=>{if(h=!0,null==i)return i={x:t.x,y:t.y},s={x:t.x,y:t.y},this.triger("start",s),void(a=!0);if(e&&null==o)return l=!0,F(i,e)<F(i,t)&&(i={x:t.x,y:t.y},s={x:t.x,y:t.y}),o={x:e.x,y:e.y},void(n={x:e.x,y:e.y});if(!e&&o)return l=!1,o=null,void(n=null);let d=I(s,t,n,e),c=U(s,t,n,e),p=O(s,t,n,e);s={x:t.x,y:t.y},n=e?{x:e.x,y:e.y}:null;let u=I(i,s,o,n),m=U(i,s,o,n),x=C(u),y=O(i,s,o,n),f=this.debug&&`${i&&"Start: "+JSON.stringify(i)},\n\t\t${s&&"This: "+JSON.stringify(s)}, \n\t\t${o&&"Start secound: "+JSON.stringify(o)}, \n\t\t${n&&"Start this: "+JSON.stringify(n)},\n\t\t${d&&"Delta: "+JSON.stringify(d)},\n\t\t${"Zoom: "+m},\n\t\t${"DZoom: "+c}\n\t\t${"Angle: "+y}\n\t\t${"DAngle: "+p}\n\t\t${"isPrimary: "+(!l&&0==r||1==r)}\n\t\t${this.last_error}`,v={delta:d,direction:u,startPosition:i,position:s,distance:x,click:a,isClick:a,mouseDown:r,zoom:m,deltaZoom:c,touchSecound:l,angle:y,deltaAngle:p,isPrimary:!l&&0==r||1==r,debug:f,centerPosition:this.centerPosition};this.triger("force",v),x>this.deadzone&&(a=!1,Math.abs(u.x)>Math.abs(u.y)?u.x>0?this.triger("right",v):this.triger("left",v):u.y>0?this.triger("down",v):this.triger("up",v))},u=t=>{if(t.preventDefault(),0==h)return;let e={x:0,y:0},d=I(i,s,o,n),c=U(i,s,o,n),p=O(i,s,o,n),u=C(d),m=this.debug&&`${i&&"Start: "+JSON.stringify(i)},\n\t\t${s&&"This: "+JSON.stringify(s)}, \n\t\t${o&&"Start secound: "+JSON.stringify(o)}, \n\t\t${n&&"Start this: "+JSON.stringify(n)},\n\t\t${e&&"Delta: "+JSON.stringify(e)},\n\t\t${"Zoom: "+c},\n\t\tDZoom: 0\n\t\t${"Angle: "+p}\n\t\tDAngle: 0\n\t\t${"isPrimary: "+(!l&&0==r||1==r)}\n\t\t${this.last_error}`;const x={x:i.x,y:i.y,delta:e,direction:d,startPosition:i,position:s,distance:u,click:a,isClick:a,mouseDown:r,zoom:c,deltaZoom:0,touchSecound:l,angle:p,deltaAngle:0,isPrimary:!l&&0==r||1==r,debug:m,centerPosition:this.centerPosition};h=!1,l=!1;let y=i;a&&(t.button&&(1===t.button&&this.triger("bmiddle",x),2===t.button&&this.triger("bright",x)),y&&this.triger("click",x)),this.triger("stop",x),i=null,s=null,o=null,n=null,r=0};t.addEventListener("touchstart",(t=>{t.preventDefault()}),!1),t.addEventListener("touchmove",d,!1),t.addEventListener("touchend",u,!1),t.addEventListener("touchstart",d,!1),t.addEventListener("mouseleave",u,!1),t.addEventListener("mousemove",c),t.addEventListener("mouseup",u),t.addEventListener("mousedown",(t=>{r=1+t.button,c(t)}))}z.prototype.update=function(t,e){this.pasive=0,e.teamMembers[this.team]+=1,t.moveToword(this.toword.x,this.toword.y),this.lastPos=t.model.position,this.shoot&&t.shoot(),1==this.shoot&&(this.shoot=0),this.exit&&t.exit(),this.exit=!1},z.prototype.direction=function(t,e){this.toword={x:null==t?this.toword.x:t,y:null==e?this.toword.y:e}},z.prototype.killed=function(t){t.team==this.team?this.shield-=1:this.shield+=1,this.shield<1&&(this.shield=1)},z.prototype.getInstructions=function(t,e){this.pasive=0,e.teamMembers[this.team]+=1,this.toword.y,this.lastPos=t.model.position;var i={a:this.toword.x<0?1:0,w:this.toword.y>0?1:0,s:this.toword.y<0?1:0,d:this.toword.x>0?1:0,e:this.exit,f:this.shoot};return 1==this.shoot&&(this.shoot=0),this.exit=!1,i},b.prototype.update=function(t,e){e.teamMembers[this.team]+=1;var i=e.getWorldSlice(t.model.position,6);i.helth=t.helth;var o,s,n,r=this;this.evry+=1,this.evry%20==0&&("http://127.0.0.1:6060/",o=i,s=function(t){r.direction(20*t.right-20*t.left,20*t.up-20*t.down),r.shoot=t.shoot,r.exit=t.exit},(n=new XMLHttpRequest).onreadystatechange=function(){4==n.readyState&&200==n.status&&(console.log(n.responseText),s(JSON.parse(n.responseText)))},n.open("GET","http://127.0.0.1:6060/?data="+encodeURIComponent(JSON.stringify(o)),!0),n.send()),this.pasive=0,e.teamMembers[this.team]+=1,t.moveToword(this.toword.x,this.toword.y),this.lastPos=t.model.position,this.shoot&&t.shoot(),1==this.shoot&&(this.shoot=0),this.exit&&t.exit(),this.exit=!1},b.prototype.killed=function(t){t.team==this.team?this.shield-=1:this.shield+=1,this.shield<1&&(this.shield=1)},b.prototype.direction=function(t,e){this.toword={x:t,y:e}},w.prototype.free=function(t,e){var i=e/2,o={map:0,coliders:[],pickables:[]};if(this.map)for(var s={x:t.x/20+.5<<0,y:t.z/20+.5<<0},n=-1;n<2;n++)for(var r=-1;r<2;r++){var a=s.x+n,l=s.y+r,d=this.map.getPos(a,l);d>o.map&&h(t,{x:20*a,y:0,z:20*l},i+10)&&(o.map=d)}for(n=0;n<this.coliders.length;n++){var c=this.coliders[n];h(t,c.model.position,i+c.size/2)&&o.coliders.push(c)}for(n=0;n<this.pickables.length;n++){var p=this.pickables[n];h(t,p.model.position,i+p.size/2)&&o.pickables.push(p)}return o},w.prototype.getWorldSlice=function(t,e){var i={actors:[],map:[]},o=t.x/20+.5<<0,s=t.z/20+.5<<0,n=e/2<<0;if(this.map)for(var r=-n;r<=n;r++)for(var a=-n;a<=n;a++){var l=o+r,d=s+a;i.map.push(this.map.getPos(l,d))}for(r=0;r<this.coliders.length;r++){var c=this.coliders[r];h(t,c.model.position,n+c.size/2)&&i.actors.push({x:c.model.position.x-t.x,y:c.model.position.y-t.y,z:c.model.position.z-t.z,t:c.team})}return i},w.prototype.getYDisp=function(t){return this.map.getYDisp(t.x/20+.5<<0,t.z/20+.5<<0)},w.prototype.addColider=function(t){t.phyEnable=!0,this.coliders.push(t)},w.prototype.removeColider=function(t){this.coliders=this.coliders.filter((function(e){return e!=t})),this.pickables=this.pickables.filter((function(e){return e!=t}))},w.prototype.addPickable=function(t){t.phyEnable=!0,this.pickables.push(t)},T.prototype.clear=function(){this.data={legend:{},resource:{}}},T.prototype.addItem=function(t,e,i,o,s,n){this.data.legend[t]={mes:e,tex:i,lvl:o,ydisp:s||0,width:n+1},this.itemNum+=1},T.prototype.getWidth=function(t){return this.data.legend[t]&&this.data.legend[t].width?this.data.legend[t].width-1:-1},T.prototype.getLevel=function(t){return this.data.legend[t]&&this.data.legend[t].lvl?this.data.legend[t].lvl:0},T.prototype.getItem=function(t){return this.data.legend[t]?this.data.legend[t]:this.data.legend[0]},T.prototype.getYDisp=function(t){return this.data.legend[t]?this.data.legend[t].ydisp:this.data.legend[0].ydisp},T.prototype.addResource=function(t,e,i){this.data.resource[t]={url:e,type:i}},T.prototype.save=function(){var t=JSON.stringify(this.data),e="data:text/json;charset=utf8,"+encodeURIComponent(t);window.open(e,"_blank"),window.focus()},T.prototype.load=function(t){this.data=JSON.parse(t)},T.prototype.getToLoad=function(t){var e=[],i=0;for(var o in this.data.resource)this.data.resource.hasOwnProperty(o)&&this.data.resource[o].type==t&&e.push({id:o,num:i++,url:this.data.resource[o].url});return e},_.prototype.generateMap=function(t,e){this.map=[];for(var i=0;i<e;i++){for(var o=[],s=0;s<t;s++)if(0==s||s==t-1||0==i||i==e-1)o.push(1);else if(s>0&&s<4&&i<e-1&&i>e-6)o.push(0);else if(i<=5)o.push(0);else{var n=Math.floor(80*Math.random());n>12&&(n=0),n>9&&3==(n-=8)&&(n=1),i<10&&3==n&&(n=0),o.push(n)}this.map.push(o)}},_.prototype.getPos=function(t,e){if(t<0||e<0||t>=this.map[0].length||e>=this.map.length)return 2;var i=this.map[e][t];return this.legend.getLevel(i)},_.prototype.getYDisp=function(t,e){return t<0||e<0||t>=this.map[0].length||e>=this.map.length?0:this.legend.getYDisp(this.map[e][t])},_.prototype.draw=function(){},_.prototype.makeStatic=function(){var t=[],e=[];this.chunks=[];for(var i=0,o=0,s=this.chunkSize,n=0;n<this.map.length;n++)for(var r=this.map[n],a=0;a<r.length;a++){var h=r[a];-1==e.indexOf(h)&&e.push(h),i=i<Math.floor(a/s)?Math.floor(a/s):i,o=o<Math.floor(n/s)?Math.floor(n/s):o,t.push({bx:Math.floor(a/s),by:Math.floor(n/s),t:h,p:{x:20*a,y:this.legend.getItem(h).ydisp,z:20*n}});var l=this.legend.getWidth(h);l>=0&&(t.push({bx:Math.floor(a/s),by:Math.floor(n/s),t:l,p:{x:20*a,y:this.legend.getItem(l).ydisp,z:20*n}}),-1==e.indexOf(l)&&e.push(l))}for(var d=0;d<=o;d++)for(var c=0;c<=i;c++)for(var p=0;p<e.length;p++){var u=e[p],m=t.filter((function(t){return d==t.by&&c==t.bx&&u==t.t}));if(0!=m.length){var x=[];m.forEach((function(t){x.push(t.p)}));var y=this.legend.getItem(u);this.chunks.push({bx:c,by:d,t:p,ren:this.engine.getObjectsStatic({x:0,y:0,z:0},x,y.mes,y.tex,!1,y.ydisp<-1?"water":"defolt")})}}},_.prototype.drawStatic=function(t,e){var i=this.chunkSize,o=this,s=Math.floor(t/20/i),n=Math.floor(e/20/i);s==this.oldx&&n==this.oldy||(this.oldx=s,this.oldy=n,this.objects.forEach((function(t){o.engine.remObject(t)}),this),this.objects=[],this.chunks.forEach((function(t){Math.abs(t.bx-s)<o.nChunks&&Math.abs(t.by-n)<o.nChunks&&(o.engine.addRender(t.ren),o.objects.push(t.ren))})))},_.prototype.resetUnits=function(){this.units=this.units.concat(this.unitRelease),this.unitRelease=[]},_.prototype.getUnits=function(t,e){var i=this.chunkSize,o=this,s=Math.floor(t/20/i),n=Math.floor(e/20/i),r=[];return this.units=this.units.filter((function(t){return!(Math.abs(Math.floor(t.x/20/i)-s)<o.nChunks&&Math.abs(Math.floor(t.z/20/i)-n)<o.nChunks&&(r.push(t),1))})),this.unitRelease=this.unitRelease.concat(r),r},_.prototype.drawEdit=function(t,e){if(Math.floor(t/20)!=this.oldx||Math.floor(e/20)!=this.oldy){this.oldx=Math.floor(t/20),this.oldy=Math.floor(e/20);var i=this;this.objects.forEach((function(t){i.engine.remObject(t)}),this),this.objects=[];var o=0,s=0,n=0;this.map.forEach((function(r){r.forEach((function(n){if(Math.abs(o-t)<200&&Math.abs(s-e)<200){i.objects.push(i.getObject(n,{x:o,y:0,z:s}));var r=i.legend.getWidth(n);r>=0&&i.objects.push(i.getObject(r,{x:o,y:0,z:s}))}o+=20})),n<o&&(n=o),s+=20,o=0}))}},_.prototype.getObject=function(t,e){var i=null,o=t,s=this.legend.getItem(t);return e.y+=s.ydisp,o<this.legend.itemNum&&(i=engine.getObject(e,s.mes,s.tex,!0)),i},_.prototype.setObject=function(t){return this.setUnits?this.setUnit({t:this.curType,x:t.position.x,y:0,z:t.position.z}):(this.map[Math.floor(t.position.z/20)][Math.floor(t.position.x/20)]=this.curType,this.oldx=-1),t},_.prototype.setUnit=function(t){this.resetUnits(),this.units.push(t),this.removeCopys()},_.prototype.removeCopys=function(){var t=[];this.units=this.units.filter((function(e){for(var i=0;i<t.length;i++)if(t[i].x==e.x&&t[i].z==e.z)return!1;return t.push(e),!0}))},_.prototype.clickBolck=function(t){return this.map[Math.floor(t.position.z/20)][Math.floor(t.position.x/20)]==this.curType?this.changeType(t):this.setObject(t)},_.prototype.changeType=function(t,e){return e?this.curType+=1:this.curType-=1,this.setUnits?t:(this.curType<0&&(this.curType=this.legend.itemNum-1),this.curType%=this.legend.itemNum,this.engine.remObject(t),t=this.getObject(this.curType,t.position))},_.prototype.changeUnit=function(t){return this.setUnits=!this.setUnits,this.curType=0,this.engine.remObject(t),this.getObject(this.curType,t.position)},M.prototype.addType=function(t,e,i,o,s,n){this.patern[t]={type:e,models:i,models1:s,texts:o,texts1:n}},M.prototype.getVehicle=function(t,e,i){var o=null;if(this.patern[t]){var s=this.engine.getAObject(e,this.patern[t].models,this.patern[t].texts,!0);if(console.log("this.patern[id].type",this.patern[t].type),this.patern[t].models1){var n=this.engine.getAObject({x:e.x,y:e.y+5,z:e.z},this.patern[t].models1,this.patern[t].texts1,!0);o=new(P(this.patern[t].type))(s,n,this.controler)}else o=new(P(this.patern[t].type))(s,this.controler);return i&&o.setDriver(i),this.physics.addColider(o),this.controler.add(o),o}},E.prototype.add=function(t,e,i,o){this.units[t]={type:e,driver:i,team:o}},E.prototype.draw=function(t){t=t.concat(this.onHold),this.onHold=[];for(var e=0;e<t.length;e++){var i=t[e],o=this.units[i.t];o&&(0==this.physics.free(i,20).coliders.length?o.driver?(console.log("cind.driver",o.driver),this.vehicleControler.getVehicle(o.type,i,new(P(o.driver))(o.team))):this.vehicleControler.getVehicle(o.type,i):this.onHold.push(i))}},R.prototype.update=function(t){this.helth-=t,this.model.rotation+=t,this.model.position.y+=.05*Math.sin(this.model.rotation),this.helth<0&&(this.valid=!1)},S.prototype.update=function(t,e){if(this.valid){var i=Math.sin(this.model.rotation)*this.speed*t,o=Math.cos(this.model.rotation)*this.speed*t;this.model.position.x+=i,this.model.position.z+=o,this.model1.position.x=this.model.position.x-7*Math.sin(this.model.rotation),this.model1.position.z=this.model.position.z-7*Math.cos(this.model.rotation),this.range-=Math.abs(i)+Math.abs(o),this.lightsize=30+2*Math.sin(this.range),this.model1.size=1+.3*Math.sin(this.range),this.range<0&&(this.valid=!1);var s=e.free(this.model.position,2);s.map>1&&(this.valid=!1);for(var n=0;n<s.coliders.length;n++){var r=s.coliders[n];r!=this.shooter&&(this.valid=!1,r.demage({value:this.dmg,owner:this.owner},d(r.model.position,this.model.position),e))}}},A.prototype.update=function(t,e){var i=Math.sin(this.rotation),o=Math.cos(this.rotation),s=this.position.x,n=this.position.z;for(this.model.size=Math.sin(this.anim*Math.PI*5),this.anim<0&&(this.valid=!1,this.calculated=!1),this.anim-=t;!this.calculated&&this.range>0;){this.range-=Math.abs(i)+Math.abs(o);var r=e.free({x:s,y:this.model.position.y,z:n},2);r.map>1&&(this.calculated=!0);for(var a=0;a<r.coliders.length;a++){var h=r.coliders[a];h!=this.shooter&&(this.calculated=!0,h.demage({value:this.dmg,owner:this.owner},d(h.model.position,{x:s,y:this.model.position.y,z:n}),e))}s+=i,n+=o}this.valid?(this.model.position.x=this.shooter.model.position.x+10*Math.sin(this.shooter.model.rotation),this.model.position.z=this.shooter.model.position.z+10*Math.cos(this.shooter.model.rotation),this.model.rotation=this.shooter.model.rotation+Math.PI):(this.model.position.x=s,this.model.position.z=n)},D.prototype.update=function(t,e){this.model.position.x=this.owner.model.position.x+(this.owner.helthMax-this.owner.helth)/15,this.model1.position.x=this.owner.model.position.x-this.owner.helth/15,this.model1.position.z=this.model.position.z=this.owner.model.position.z,this.model1.position.y=this.model.position.y=this.owner.model.position.y+this.plusY,this.model.size={x:this.owner.helth/150,y:.1,z:.1},this.model1.size={x:(this.owner.helthMax-this.owner.helth)/150,y:.1,z:.1},this.owner.valid||(this.valid=!1)},k.prototype.update=function(t,e){this.model.size+=t*this.grow,this.model.size>this.size&&(this.grow=-4),this.model.size<this.size/2&&this.grow<0&&(this.valid=!1),this.lightsize=40*this.model.size},L.prototype.update=function(t){this.player.pasive++,this.engine.lights.clear();for(var e=this,i=0;i<this.temps.length;i++)this.temps[i].update(t,this.physics),this.temps[i].light&&this.engine.lights.addLight(this.temps[i].light,this.temps[i].model1?this.temps[i].model1.position:this.temps[i].model.position,this.temps[i].lightsize);for(this.temps=this.temps.filter((function(t){return!!t.valid||(e.unbind(t),!1)}));this.latetems.length>0;)this.createExplosion(this.latetems.pop(),.5)},L.prototype.unbind=function(t){t.phyEnable&&this.physics.removeColider(t),0==t.typeNum&&this.latetems.push(t),this.engine.remObject(t.model),t.model1&&this.engine.remObject(t.model1)},L.prototype.invalidate=function(){var t=this;this.temps=this.temps.filter((function(e){return t.unbind(e),!1}))},L.prototype.add=function(t){t.valid=!0,this.temps.push(t)},L.prototype.shoot=function(t,e,i,o,s,n){this.sound.playSound(t.model.position,"launch");var r=this.engine.getObject({x:t.model.position.x+7*Math.sin(i),y:t.model.position.y+e,z:t.model.position.z+7*Math.cos(i)},"proj","grid",!0),a=this.engine.getEfect({x:t.model.position.x,y:t.model.position.y+e,z:t.model.position.z},"trail","trail",!0);r.rotation=i,a.rotation=i,this.add(new S(t,r,a,o,s,n,t.driver))},L.prototype.shootB=function(t,e,i,o,s){this.sound.playSound(t.model.position,"shot");var n=this.engine.getEfect({x:t.model.position.x+10*Math.sin(i),y:t.model.position.y+e,z:t.model.position.z+10*Math.cos(i)},"trail","trail",!0);n.rotation=i+Math.PI,this.add(new A(t,n,o,s,t.driver))},L.prototype.createBarr=function(t){var e=this.engine.getEfect({x:t.model.position.x,y:t.model.position.y+.75*t.size,z:t.model.position.z},"cone","power1",!0),i=this.engine.getEfect({x:t.model.position.x,y:t.model.position.y+.75*t.size,z:t.model.position.z},"cone","power",!0);this.add(new D(t,e,i))},L.prototype.createExplosion=function(t,e){var i=this;if(e>1){this.sound.playSound(t.model.position,"explosion");var o=this.engine.getObject({x:t.model.position.x,y:i.physics.getYDisp(t.model.position)+1,z:t.model.position.z},"plane","dirt",!0);o.size=t.model.size,setTimeout((function(){i.engine.remObject(o)}),1e4);var s=this.engine.getEfect({x:t.model.position.x,y:i.physics.getYDisp(t.model.position)+2,z:t.model.position.z},"plane","star",!0);this.add(new k(e*t.model.size,s,!1))}var n=this.engine.getEfect({x:t.model.position.x,y:t.model.position.y+5*e,z:t.model.position.z},"explosion","explosion",!0);this.add(new k(e,n,!0))},L.prototype.createPickable=function(t,e,i,o){var s=null;0==e&&(s=this.engine.getObject({x:t.model.position.x,y:t.model.position.y,z:t.model.position.z},"pcube","pspeed",!0)),1==e&&(s=this.engine.getObject({x:t.model.position.x,y:t.model.position.y,z:t.model.position.z},"pcube","pgun",!0)),2==e&&(s=this.engine.getObject({x:t.model.position.x,y:t.model.position.y,z:t.model.position.z},"pcube","phelth",!0)),3==e&&(s=this.engine.getObject({x:t.model.position.x,y:t.model.position.y,z:t.model.position.z},"pcube","pinvins",!0));var n=new R(e,i,o,s);this.physics.addPickable(n),this.add(n)},L.prototype.exit=function(t,e){var i=new p(this.engine.getAObject(t,["mans","manl","mans","manr"],["mangreen","manblue","manred"],!0),this,e);return this.physics.addColider(i),this.add(i),i},L.prototype.makeBloodStain=function(t){var e=this,i=this.engine.getObject({x:t.x,y:e.physics.getYDisp(t)+1,z:t.z},"plane","bloodstain",!0);i.size=.4,setTimeout((function(){e.engine.remObject(i)}),1e4)},L.prototype.sceneScope=function(t){return this.player.pasive<3?h(t,this.player.lastPos,240):1},B.prototype.sub=function(t,e){this.events[t]&&this.events[t].push(e)},B.prototype.onClick=function(t){this.events.click.push(t)},B.prototype.onForce=function(t){this.events.force.push(t)},B.prototype.onStop=function(t){this.events.stop.push(t)},B.prototype.onUp=function(t){this.events.up.push(t)},B.prototype.onDown=function(t){this.events.down.push(t)},B.prototype.onLeft=function(t){this.events.left.push(t)},B.prototype.onRight=function(t){this.events.right.push(t)},B.prototype.unsub=function(t,e){this.events[t]&&(this.events[t]=this.events[t].filter((t=>t!==e)))},B.prototype.clearEvlent=function(t){this.events[t]&&(this.events[t]=[])},B.prototype.clear=function(){this.events={up:[],down:[],left:[],right:[],stop:[],start:[],click:[],force:[],bmiddle:[],bright:[]}},B.prototype.triger=function(t,e){this.events[t]&&this.events[t].forEach((t=>{try{t(e)}catch(t){if(this.console_error&&console.log(t),this.last_error="Error: "+t.name+" "+t.foo+" "+t.message+" "+t.stack,this.throw_error)throw t}}))};const j=B;var V=["position","normal","uv"],G=["sampler","samplerShadowMap","sampler2","Flights","source_direction","inv_trans","Pmatrix","Vmatrix","Mmatrix","Lmatrix","PmatrixLight"],X=null,Y=null,H=null,K=null;document.getElementById("windiv");function W(){var t=document.getElementById("loading");t.parentNode.removeChild(t)}function $(){Y.direction(-20,null)}function J(){Y.direction(20,null)}function q(){Y.direction(null,20)}function Z(){Y.direction(null,-20)}function Q(){Y.direction(0,0)}function tt(){Y.direction(null,0)}function et(){Y.direction(0,null)}function it(t){console.log(t),t.isPrimary?Y.shoot=1:nt()}function ot(){Y.shoot=2}function st(){Y.shoot=0}function nt(){Y.exit=!0}function rt(t){}function at(){var t=document.getElementById("canvas");t.style.width=window.innerWidth-10,t.style.height=window.innerHeight-10,t.width=window.innerWidth-10,t.height=window.innerHeight-10,r.gameResize()}window.onload=function(){var t=new r.Engine,e=document.getElementById("canvas");H=document.getElementById("scorediv"),K=document.getElementById("windiv");var i=new j(e,10);i.sub("up",q),i.sub("down",Z),i.sub("left",J),i.sub("right",$),i.sub("click",it),i.sub("stop",Q),i.sub("force",rt),t.selectCanvas(e),t.initShadersPackage({name:"defolt",program:null,vertex:"\nattribute vec3 position, normal;\nattribute vec2 uv;\nuniform mat4 Pmatrix, Vmatrix, Mmatrix, Lmatrix, PmatrixLight;\nvarying vec2 vUV;\nvarying vec3 vNormal, vLightPos;\nvarying vec3 hPos;\n\nvoid main(void) {\n\n//Shadow mapping : \nvec4 lightPos = Lmatrix*Mmatrix*vec4(position, 1.);\nlightPos=PmatrixLight*lightPos;\nvec3 lightPosDNC=lightPos.xyz/lightPos.w;\nvLightPos=vec3(0.5,0.5,0.5)+lightPosDNC*0.5;\nvec3 rPos=vec3(Mmatrix*vec4(position, 1.));\nhPos=rPos;\ngl_Position = Pmatrix*Vmatrix*vec4(rPos, 1.);\nvNormal=normal;\nvUV=uv;\n}",fragment:"\nprecision mediump float;\nuniform sampler2D sampler, samplerShadowMap;\nuniform float Flights[30];\nuniform vec3 source_direction;\nuniform mat3 inv_trans;\nvarying vec2 vUV;\nvarying vec3 vNormal, vLightPos;\nvarying vec3 hPos;\nconst vec3 source_ambient_color=vec3(1.,1.,1.);\nconst vec3 source_diffuse_color=vec3(1.,1.,1.);\nconst vec3 mat_ambient_color=vec3(0.3,0.3,0.3);\nconst vec3 mat_diffuse_color=vec3(1.,1.,1.);\nconst float mat_shininess=10.;\n\nvoid main(void) {\nvec3 mat_ambijent_add=vec3(.0,.0,.0);\nvec3 nNorm=vNormal*inv_trans;\nfor(int i=0;i<24;i+=7)\n{\n    vec3 raz=vec3(Flights[i+3]+0.001,Flights[i+4],Flights[i+5])-hPos;\n      mat_ambijent_add+=max(Flights[i+6]-length(raz),0.)/(Flights[i+6]+0.001)*vec3(Flights[i],Flights[i+1],Flights[i+2])*max(.2, dot(nNorm,normalize(raz)));\n}\nvec2 uv_shadowMap=vLightPos.xy;\nfloat shadowCoeff=0.0;\nfloat texelSize = 1.0 / 1024.0;\n{\n  for(int i=-1;i<2;i++)\n    for(int j=-1;j<2;j++)\n      shadowCoeff+=1.-smoothstep(0.005, 0.006, vLightPos.z-texture2D(samplerShadowMap, uv_shadowMap+vec2(i,j)*texelSize).r);\n}\nshadowCoeff/=9.0;\nvec4 color4=texture2D(sampler, vUV);\nvec3 I_ambient=source_ambient_color*(mat_ambient_color+mat_ambijent_add);\nvec3 I_diffuse=source_diffuse_color*mat_diffuse_color*max(0., dot(vNormal, source_direction));\n\nvec3 I=I_ambient+shadowCoeff*I_diffuse;\ngl_FragColor = vec4(I*color4.rgb, color4.a);\n}",uniform:G,attribute:V}),t.initShadersPackage({name:"water",program:null,vertex:"\nattribute vec3 position, normal;\nattribute vec2 uv;\nuniform mat4 Pmatrix, Vmatrix, Mmatrix, Lmatrix, PmatrixLight;\nuniform vec3 cameraPosition;\nvarying vec3 cPos;\nvarying vec2 vUV;\nvarying vec3 vNormal, vLightPos;\nvarying vec3 hPos;\nvoid main(void) {\n\n//Shadow mapping : \nvec4 lightPos = Lmatrix*Mmatrix*vec4(position, 1.);\nlightPos=PmatrixLight*lightPos;\nvec3 lightPosDNC=lightPos.xyz/lightPos.w;\nvLightPos=vec3(0.5,0.5,0.5)+lightPosDNC*0.5;\nvec3 rPos=vec3(Mmatrix*vec4(position, 1.));\ncPos=vec3(Mmatrix*vec4(position-cameraPosition, 1.));\nhPos=rPos;\ngl_Position = Pmatrix*Vmatrix*vec4(rPos, 1.);\nvNormal=normal;\nvUV=uv;\n}",fragment:"\nprecision mediump float;\nuniform sampler2D sampler;  \nuniform sampler2D samplerShadowMap;   \nuniform sampler2D sampler2;   \nuniform float Flights[30];\nuniform float time;\nuniform vec3 source_direction;\nvarying vec2 vUV;\nvarying vec3 vNormal, vLightPos;\nvarying vec3 hPos;\nvarying vec3 cPos;\nuniform mat3 inv_trans;\nconst vec3 source_ambient_color=vec3(1.,1.,1.);\nconst vec3 source_diffuse_color=vec3(1.,1.,1.);\nconst vec3 mat_ambient_color=vec3(0.3,0.3,0.3);\nconst vec3 mat_diffuse_color=vec3(1.,1.,1.);\nconst float mat_shininess=20.;\n\nvoid main(void) {\nvec3 mat_ambijent_add=vec3(.0,.0,.0);\nvec3 nNorm=vNormal*inv_trans;\nfor(int i=0;i<24;i+=7)\n{\n    vec3 raz=vec3(Flights[i+3]+0.001,Flights[i+4],Flights[i+5])-hPos;\n      mat_ambijent_add+=max(Flights[i+6]-length(raz),0.)/(Flights[i+6]+0.001)*vec3(Flights[i],Flights[i+1],Flights[i+2]);\n}\nvec2 uv_shadowMap=vLightPos.xy;\nfloat shadowCoeff=0.0;\nfloat texelSize = 1.0 / 1024.0;\n{\n  for(int i=-1;i<2;i++)\n    for(int j=-1;j<2;j++)\n      shadowCoeff+=1.-smoothstep(0.005, 0.006, vLightPos.z-texture2D(samplerShadowMap, uv_shadowMap+vec2(i,j)*texelSize).r);\n}\nshadowCoeff/=9.0;\nvec2 wave_shift = vec2(cos(time*.05+hPos.x*.0525+hPos.z*.02), sin(time*.05+hPos.z*.0525+hPos.x*.02))*0.1;\nvec4 color4=texture2D(sampler, hPos.xz*0.05 + vec2(-hPos.z*0.01 + time*.00051+time*.00061) + wave_shift)+\ntexture2D(sampler,vec2(-hPos.x+time*.012,-hPos.z+hPos.x*0.3+0.5+time*.01)*0.051 - wave_shift*0.8)*vec4(0.6,0.6,0.6,0.1)+\ntexture2D(sampler2, cPos.xz*0.01 \n  + wave_shift*1.5)*\n  vec4(0.6,0.6,0.6,0.1);\nvec3 I_ambient=source_ambient_color*(mat_ambient_color+mat_ambijent_add);\nvec3 I_diffuse=source_diffuse_color*mat_diffuse_color*max(0., dot(vNormal, source_direction));\n\nvec3 I=I_ambient+shadowCoeff*I_diffuse;\ngl_FragColor = vec4(I*color4.rgb, color4.a);\n}",uniform:G.concat(["time","cameraPosition"]),attribute:V}),t.initShaders(),t.initShadersPackage({name:"shadow",program:null,vertex:"\nattribute vec3 position;\nattribute vec2 uv;\nuniform mat4 Pmatrix, Lmatrix,Mmatrix;\nvarying float vDepth;\nvarying vec2 vPos;\nvarying vec2 vUV;\nvoid main(void) {\nvec4 position = Pmatrix*Lmatrix*Mmatrix*vec4(position, 1.);\nvPos=vec2(position.x,position.z);\nfloat zBuf=position.z/position.w; //Z-buffer between -1 and 1\nvDepth=0.5+zBuf*0.5; //between 0 and 1\ngl_Position=position;\nvUV=uv;\n}",fragment:"\nprecision mediump float;\nvarying float vDepth;\nvarying vec2 vPos;\nvarying vec2 vUV;\nuniform sampler2D sampler;\nvoid main(void) {\n    if(texture2D(sampler, vUV).a>0.3)\n      gl_FragColor=vec4(vDepth, 0.,vDepth,1.);\n}",uniform:G,attribute:V}),t.initShaders(),t.initShadersPackage({name:"efects",program:null,vertex:"attribute vec3 position;\nattribute vec2 uv;\nuniform mat4 Pmatrix, Vmatrix, Mmatrix;\nvarying vec2 vUV;\n            void main(void) { //pre-built function\n               gl_Position = Pmatrix*Vmatrix*Mmatrix*vec4(position, 1.);\n               vUV=uv;\n            }",fragment:"\nprecision mediump float;\nuniform sampler2D sampler;\nvarying vec2 vUV;\n            void main(void) {\n               gl_FragColor = texture2D(sampler, vUV);\n            }",uniform:G,attribute:V}),t.initShaders(),a.init(),a.requestSound("shot","./data/shot.wav"),a.requestSound("explosion","./data/explosion.wav"),a.requestSound("launch","./data/launch.wav");var o=new T;!function(t){t.addResource("tank2","data/tank2.txt",t.tMesh),t.addResource("plane","data/plane.txt",t.tMesh),t.addResource("proj","data/projectile.txt",t.tMesh),t.addResource("brick","data/groundbox.txt",t.tMesh),t.addResource("explosion","data/explosion12.txt",t.tMesh),t.addResource("hole","data/hole.txt",t.tMesh),t.addResource("mine","data/mine.txt",t.tMesh),t.addResource("kucica","data/kucica.txt",t.tMesh),t.addResource("cone","data/cone.txt",t.tMesh),t.addResource("barrel","data/barrel.txt",t.tMesh),t.addResource("pcube","data/pcube.txt",t.tMesh),t.addResource("trail","data/trail.txt",t.tMesh),t.addResource("mans","data/mans.txt",t.tMesh),t.addResource("manr","data/manr.txt",t.tMesh),t.addResource("manl","data/manl.txt",t.tMesh),t.addResource("tankgun","data/tankgun.txt",t.tMesh),t.addResource("choper","data/choperb.txt",t.tMesh),t.addResource("bridge","data/bridge.txt",t.tMesh),t.addResource("bridge90","data/bridge90.txt",t.tMesh),t.addItem(0,"brick","grass"),t.addItem(1,"kucica","kucica",2,0,0),t.addItem(2,"brick","cursor",2,20,0),t.addItem(3,"plane","water",1,-9),t.addItem(4,"bridge","road",0,1,3),t.addItem(5,"bridge90","road",0,1,3),t.addItem(6,"brick","road2",0,1,3)}(o);var s=o.getToLoad(o.tMesh),n=new r.Loader(t);s.forEach((function(t){n.add(t.id,t.url,1)}),this),n.onLoad((function(i){t.loadTexture("explosion","img/explosion1.png"),t.loadTexture("barrel","img/barrel.png"),t.loadTexture("water","img/water8.1.png","/img/clouds.png"),t.loadTexture("kucica","img/kucica2.png"),t.loadTexture("to2","img/rest3.png"),t.loadTexture("tankg","img/tankg.png"),t.loadTexture("tankb","img/tankb.png"),t.loadTexture("brick","img/mbrick2.png"),t.loadTexture("mine","img/mine.png"),t.loadTexture("grass","img/grass1.png"),t.loadTexture("base","img/base.png"),t.loadTexture("fanceb","img/fanceb.png"),t.loadTexture("fence1","img/fence1.png"),t.loadTexture("fence2","img/fence2.png"),t.loadTexture("concrete","img/concrete.png"),t.loadTexture("power","img/power.png"),t.loadTexture("power1","img/power1.png"),t.loadTexture("grid","img/grid.png"),t.loadTexture("star","img/star.png"),t.loadTexture("dirt","img/dirt.png"),t.loadTexture("pgun","img/pgun.png"),t.loadTexture("phelth","img/phelth.png"),t.loadTexture("pinvins","img/pinvins.png"),t.loadTexture("pspeed","img/pspeed.png"),t.loadTexture("trail","img/trail.png"),t.loadTexture("mans","img/mans.png"),t.loadTexture("mangreen","img/mangreen.png"),t.loadTexture("manblue","img/manblue.png"),t.loadTexture("tankgunr","img/tankgunr.png"),t.loadTexture("tankgunb","img/tankgunb.png"),t.loadTexture("tankgung","img/tankgung.png"),t.loadTexture("choperb","img/choperb.png"),t.loadTexture("choperg","img/choperg.png"),t.loadTexture("elise","img/elise.png"),t.loadTexture("elise1","img/elise1.png"),t.loadTexture("road","img/road.png"),t.loadTexture("road2","img/road2.png"),t.loadTexture("cursor","img/cursor.png"),t.loadTexture("bloodstain","img/bloodstain.png"),function(i){X.lookAt(0,120,-30,0,0,0,0,1,0),X.setProjection(.6,e.width,e.height,1,1e3,!0),r.gameResize=function(){X.setProjection(.6,t.preview[0],t.preview[1],1,1e3,!0)};for(var s=JSON.parse('[[[3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[3,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[3,0,1,6,1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,1,0,0,1,6,5,5,5,6,5,5,5,5,5,5,5,6,5,5,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[3,3,6,6,5,5,5,6,5,5,5,6,5,5,5,5,5,5,6,5,5,5,5,5,5,5,6,5,5,5,5,6,1,0,0,4,0,3,1,0,0,1,1,4,0,0,6,5,5,5,5,5,5,5,5,5,5,5,6,0,0,0,0,1],[3,3,1,6,1,0,0,4,0,1,1,4,1,1,1,0,1,1,4,1,0,0,1,1,0,0,4,1,0,0,1,0,1,0,0,4,0,3,1,0,0,0,0,6,5,5,6,5,5,5,5,5,6,5,5,5,5,6,4,0,0,0,0,1],[3,3,3,0,0,0,0,1,0,0,0,4,0,0,0,0,0,0,4,1,0,0,0,0,0,0,4,0,1,1,0,0,0,0,1,4,0,3,3,3,0,0,1,4,1,0,4,0,0,0,0,0,4,0,0,0,0,4,4,0,0,0,0,1],[3,3,3,3,0,0,0,0,0,0,0,4,1,0,6,6,0,1,4,0,0,0,0,0,1,0,4,0,0,0,0,0,0,1,0,4,0,0,1,3,0,0,1,4,1,0,4,1,6,1,0,1,4,1,6,1,0,4,4,0,0,0,0,1],[3,3,3,3,3,0,1,0,0,0,1,4,1,0,6,6,0,1,4,0,1,0,0,0,1,0,4,0,1,1,0,0,0,1,0,4,0,0,0,3,1,1,0,4,0,1,4,6,6,5,5,5,6,5,6,6,0,4,4,0,0,0,0,1],[1,0,3,3,3,3,1,0,0,0,1,4,1,0,6,6,0,0,4,0,1,0,0,0,1,0,4,1,0,0,1,0,0,0,1,6,5,5,5,5,5,5,5,6,0,1,4,1,6,1,0,1,6,1,6,1,0,4,4,0,0,0,0,1],[1,6,1,3,3,3,0,0,0,0,0,4,0,0,6,6,0,1,6,5,5,5,5,5,5,5,6,5,5,5,5,5,5,5,5,6,0,0,1,3,0,0,0,4,1,0,4,0,0,0,0,0,0,0,0,0,0,4,4,0,1,0,0,1],[1,4,0,0,3,3,3,1,1,1,0,4,1,0,0,0,0,1,4,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,3,0,0,0,6,5,5,6,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,1],[1,4,0,1,3,3,3,3,0,0,0,4,1,0,1,1,0,1,4,1,1,0,1,1,0,0,0,0,0,1,0,6,6,0,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,3,3,3,3,3],[1,4,0,1,1,3,3,3,3,0,0,6,5,5,5,5,5,5,6,1,3,3,3,3,3,1,1,0,0,1,0,6,6,0,1,3,1,0,0,4,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,1],[1,6,5,5,6,6,3,3,3,3,3,0,0,0,1,0,0,0,0,3,3,3,3,3,3,3,3,3,0,0,1,0,0,1,0,3,0,1,0,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,1],[1,0,0,0,4,0,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,1,4,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,1],[1,1,1,1,4,0,1,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,1,0,4,6,5,5,5,5,5,5,6,5,5,6,5,5,6,5,5,5,6,4,0,0,0,0,1],[1,6,1,0,4,0,6,6,0,1,3,3,3,3,3,3,3,3,3,3,3,1,6,1,0,3,3,3,3,3,0,6,5,5,5,5,5,5,5,6,6,0,1,0,0,0,0,4,0,0,4,0,0,4,1,1,1,4,4,0,0,0,0,1],[1,6,5,5,6,5,6,6,0,1,1,0,0,1,3,3,1,0,0,0,0,6,6,6,0,0,3,3,3,3,0,4,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,4,0,1,4,0,0,4,0,0,0,4,4,0,0,0,0,1],[1,6,1,0,4,0,0,0,0,0,0,0,0,3,3,3,3,0,0,0,0,1,4,1,0,0,3,3,3,3,3,4,1,0,0,0,0,1,0,4,0,1,0,0,0,0,1,6,6,1,4,0,1,4,1,0,1,4,4,0,0,0,0,1],[1,1,1,1,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,5,5,6,0,0,0,3,3,3,3,3,4,0,0,0,0,0,0,1,4,1,0,0,0,0,0,1,0,4,1,4,0,1,4,1,0,1,4,4,0,0,0,0,1],[1,0,0,0,4,1,0,0,1,0,0,0,1,3,3,3,3,0,0,0,1,0,6,5,5,5,6,3,3,3,3,4,0,0,0,0,0,0,0,4,0,0,0,0,0,0,1,0,4,1,4,0,1,4,1,1,1,4,4,0,0,0,0,1],[1,0,0,0,4,1,0,0,1,0,3,3,3,3,3,3,3,0,0,1,0,6,6,1,0,0,4,0,3,3,3,4,6,5,5,5,5,5,5,6,5,5,5,5,5,5,5,5,6,1,6,5,5,6,5,5,5,6,4,0,0,0,0,1],[1,0,0,0,4,1,0,0,1,3,3,3,3,3,3,3,0,0,1,0,6,6,1,3,1,0,4,0,3,3,3,4,4,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5,6,0,0,0,0,0,0,4,4,0,0,0,0,1],[1,0,0,0,4,0,0,0,3,3,3,3,3,3,3,1,0,0,0,0,6,6,0,1,0,0,4,0,0,3,3,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,3,3,3,3,3,4,4,0,0,0,0,1],[1,0,0,0,4,1,1,1,3,3,3,3,3,1,1,1,6,6,0,0,1,0,0,0,0,0,4,0,0,3,3,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,3,3,3,3,1,4,3,4,4,0,0,0,0,1],[1,0,0,0,4,1,0,0,3,3,3,3,6,6,5,6,5,6,0,0,1,6,5,5,5,5,6,0,0,3,3,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,3,4,6,5,5,5,5,5],[1,0,0,0,4,1,0,3,3,3,3,1,1,1,0,4,0,0,0,0,6,6,1,0,0,0,4,0,0,0,0,4,4,0,3,3,3,3,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,4,3,4,4,0,1,0,0,1],[1,0,0,0,4,0,0,3,3,3,3,6,6,6,5,6,0,0,1,0,4,1,0,0,0,0,4,0,1,1,0,4,6,5,6,6,1,0,0,0,0,0,3,3,0,0,0,0,3,3,3,3,3,3,0,4,0,4,4,1,6,1,0,1],[1,0,0,0,4,0,0,3,3,3,3,1,1,1,0,4,6,6,0,1,6,5,5,5,5,5,6,5,5,5,5,6,4,0,6,6,1,0,0,0,0,0,3,3,0,0,0,0,0,1,0,0,0,0,1,6,5,6,6,5,6,1,0,1],[1,0,0,0,4,0,0,3,3,3,6,6,6,5,5,6,6,6,0,1,4,6,5,5,5,5,6,5,5,5,5,5,6,1,6,6,1,0,0,0,0,0,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,1,6,1,0,1],[1,0,0,0,4,0,0,3,3,3,1,1,1,0,0,4,0,0,1,0,4,4,0,0,0,0,4,1,1,1,1,1,1,0,0,0,1,0,0,0,0,0,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,1,0,0,1],[1,0,0,0,4,0,0,3,3,3,6,6,6,5,5,6,5,5,5,5,6,4,1,0,0,0,4,1,6,5,5,6,1,1,1,1,1,0,0,0,0,0,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,1],[1,0,0,1,4,1,0,3,3,3,3,1,1,1,0,4,0,6,1,0,4,4,0,0,0,0,6,5,6,3,3,4,1,0,6,5,5,5,5,5,6,1,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,1],[1,0,0,1,4,1,0,3,3,3,3,6,6,6,5,6,5,6,1,0,4,4,0,0,1,0,0,1,4,3,3,4,1,0,4,0,0,0,1,0,4,3,1,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,1],[1,0,0,1,4,1,0,3,3,3,3,1,6,1,0,6,0,0,0,0,4,4,1,0,0,0,0,1,6,5,5,6,1,0,4,0,0,0,0,1,4,3,3,3,3,3,3,3,3,3,3,1,5,5,5,5,5,5,6,5,1,0,0,1],[1,0,1,1,4,1,1,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,4,0,0,0,0,3,4,1,3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,0,0,4,1,0,3,3,3,3,0,0,0,0,0,0,0,0,0,4,6,5,5,5,5,5,6,0,0,0,0,0,0,4,0,0,0,3,3,4,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,1],[1,0,1,0,4,1,0,3,3,3,3,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,4,0,0,1,0,0,0,4,0,0,0,3,3,4,3,3,3,0,0,0,0,0,3,3,3,3,3,3,0,0,0,1,1,1,0,0,1],[1,0,0,1,4,0,0,3,3,3,3,1,1,1,1,1,1,1,0,0,4,4,0,0,0,0,0,6,5,5,5,5,5,5,6,0,0,3,3,3,4,3,0,0,0,0,0,0,0,0,3,3,3,3,3,1,1,1,1,6,1,1,1,1],[1,0,0,0,4,0,0,3,3,3,3,1,6,6,6,6,6,1,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,6,0,0,0,0,0,0,0,0,0,0,3,3,3,3,6,6,6,6,6,6,6,6,1],[1,0,0,0,4,0,0,3,3,3,3,1,6,6,6,6,6,1,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,0,0,0,0,0,0,0,0,0,0,3,3,3,0,0,0,0,4,0,0,0,0,1],[1,0,0,0,4,0,0,3,3,3,3,1,1,1,4,1,1,1,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,3,0,0,0,0,0,0,0,3,3,3,3,3,0,0,0,0,4,0,0,0,0,1],[1,0,0,0,4,0,0,0,3,3,3,3,0,0,4,0,0,0,0,0,4,4,1,1,1,3,3,3,1,3,3,1,3,1,3,3,1,3,3,3,3,3,3,0,0,0,0,0,0,3,3,3,3,3,0,0,0,0,4,0,0,0,0,1],[1,0,0,0,4,0,1,0,3,3,3,3,0,0,4,0,0,0,0,0,4,4,3,3,3,1,1,1,3,1,1,3,1,3,1,1,3,3,3,3,3,3,3,3,3,0,0,0,3,3,3,3,3,3,0,0,0,0,4,0,0,0,0,1],[1,0,0,0,4,0,0,0,3,3,3,3,0,0,4,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,0,0,4,0,0,0,0,1],[1,0,0,1,6,5,5,5,5,5,5,5,5,5,6,5,5,5,5,5,6,4,5,5,5,6,6,6,5,5,5,5,5,5,0,0,0,0,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,0,0,4,0,0,0,0,1],[1,0,0,0,4,1,0,0,3,3,3,3,0,0,0,0,0,0,0,0,0,4,0,0,0,4,4,4,0,0,0,0,0,0,0,1,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,4,0,0,0,0,1],[1,0,0,1,6,5,5,5,6,5,5,5,5,6,5,5,5,5,5,5,5,6,5,5,5,6,6,6,5,5,5,5,5,5,5,5,5,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,4,1,0,0,0,1],[1,0,0,0,4,0,0,0,4,3,3,3,0,4,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,0,0,1,0,0,0,0,3,3,3,3,3,3,3,1,3,3,1,0,0,0,0,0,0,4,0,0,0,0,1],[1,0,0,1,4,0,1,0,4,3,3,3,3,4,0,0,1,1,1,0,0,0,0,0,0,4,4,4,0,0,0,6,6,6,6,6,0,1,0,1,0,0,0,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,4,0,0,0,0,1],[1,0,1,0,4,0,0,1,4,3,3,3,3,4,1,1,1,0,1,1,1,1,1,0,0,4,4,4,0,0,1,6,6,6,6,6,0,0,1,0,0,1,1,1,3,0,0,0,0,0,1,0,0,0,0,0,0,0,4,0,0,0,0,1],[1,0,1,0,4,0,0,1,6,5,5,5,5,6,1,6,6,6,6,6,6,6,1,0,0,4,4,4,0,0,0,6,6,6,6,6,0,0,1,0,0,0,1,6,5,5,5,6,5,5,6,0,0,1,0,0,0,0,4,0,0,1,0,1],[1,0,0,1,4,0,1,0,0,3,3,3,3,3,0,6,6,6,6,6,6,6,1,0,0,4,4,4,0,0,0,1,0,1,0,4,0,1,0,0,1,0,1,1,0,0,0,4,0,0,1,0,0,4,0,0,0,0,6,0,0,0,0,1],[1,0,0,0,4,1,1,1,1,1,3,3,3,3,0,6,6,6,6,6,6,6,1,0,0,4,4,4,0,0,0,1,0,1,0,4,0,0,0,0,0,0,1,0,0,0,0,4,0,0,0,0,6,1,0,0,1,0,4,0,0,0,0,1],[1,0,0,0,4,1,6,5,6,1,3,3,3,3,3,6,6,6,6,6,6,6,1,0,0,4,4,4,0,0,0,1,0,1,0,4,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,1],[1,0,1,0,4,1,4,0,4,1,0,3,3,3,3,3,1,1,1,1,1,6,5,5,5,6,6,6,5,5,5,6,5,5,5,6,5,5,5,5,5,5,5,5,5,5,5,6,5,5,5,5,5,5,5,5,5,5,6,0,0,0,0,1],[1,0,1,0,4,1,4,0,4,1,1,1,3,3,3,3,3,0,0,0,0,0,0,0,0,4,0,0,0,0,0,4,3,0,0,0,0,0,0,0,1,0,0,0,0,1,0,4,0,1,0,0,1,0,0,1,0,0,4,0,0,0,1,1],[1,0,0,0,4,1,6,5,6,5,6,1,0,3,3,3,3,3,0,0,0,0,0,0,0,6,5,5,5,5,5,6,5,5,5,5,5,5,5,5,5,5,5,6,5,5,5,6,5,5,5,5,5,5,5,5,5,5,6,0,0,0,0,1],[1,0,1,0,4,1,4,0,0,0,4,1,0,0,3,3,3,3,3,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,4,1,0,1,1,1,0,1,1,0,1,1,0,1,1,4,0,1,0,0,1],[1,0,1,0,4,1,6,5,6,5,6,1,0,0,0,3,3,3,3,3,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,6,6,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,1],[1,0,0,0,4,1,1,1,4,1,1,1,0,0,0,0,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,6,6,1,1,0,1,1,1,0,1,1,1,0,1,1,1,4,0,0,0,0,1],[1,0,0,0,6,5,5,5,5,5,5,5,5,5,5,5,6,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],[{"t":14,"x":60,"y":0,"z":100},{"t":15,"x":40,"y":0,"z":80},{"t":15,"x":60,"y":0,"z":60},{"t":9,"x":120,"y":0,"z":80},{"t":15,"x":20,"y":0,"z":200},{"t":13,"x":60,"y":0,"z":220},{"t":16,"x":120,"y":0,"z":200},{"t":16,"x":140,"y":0,"z":200},{"t":16,"x":160,"y":0,"z":200},{"t":16,"x":180,"y":0,"z":200},{"t":16,"x":200,"y":0,"z":200},{"t":16,"x":200,"y":0,"z":220},{"t":1,"x":300,"y":0,"z":200},{"t":1,"x":300,"y":0,"z":140},{"t":16,"x":260,"y":0,"z":140},{"t":16,"x":320,"y":0,"z":160},{"t":16,"x":20,"y":0,"z":260},{"t":16,"x":40,"y":0,"z":260},{"t":16,"x":80,"y":0,"z":280},{"t":16,"x":100,"y":0,"z":300},{"t":7,"x":40,"y":0,"z":300},{"t":5,"x":20,"y":0,"z":340},{"t":16,"x":200,"y":0,"z":240},{"t":16,"x":200,"y":0,"z":260},{"t":16,"x":140,"y":0,"z":340},{"t":1,"x":200,"y":0,"z":1200},{"t":1,"x":120,"y":0,"z":1200},{"t":6,"x":20,"y":0,"z":380},{"t":16,"x":40,"y":0,"z":360},{"t":16,"x":60,"y":0,"z":360},{"t":15,"x":20,"y":0,"z":460},{"t":16,"x":160,"y":0,"z":360},{"t":16,"x":160,"y":0,"z":360},{"t":2,"x":120,"y":0,"z":460},{"t":2,"x":100,"y":0,"z":580},{"t":1,"x":40,"y":0,"z":580},{"t":16,"x":220,"y":0,"z":560},{"t":13,"x":120,"y":0,"z":540},{"t":16,"x":120,"y":0,"z":520},{"t":16,"x":140,"y":0,"z":520},{"t":16,"x":260,"y":0,"z":560},{"t":13,"x":320,"y":0,"z":560},{"t":1,"x":240,"y":0,"z":560},{"t":1,"x":60,"y":0,"z":1040},{"t":16,"x":40,"y":0,"z":660},{"t":16,"x":20,"y":0,"z":660},{"t":15,"x":20,"y":0,"z":700},{"t":2,"x":40,"y":0,"z":740},{"t":3,"x":60,"y":0,"z":740},{"t":1,"x":60,"y":0,"z":760},{"t":16,"x":60,"y":0,"z":800},{"t":16,"x":60,"y":0,"z":820},{"t":5,"x":20,"y":0,"z":800},{"t":16,"x":60,"y":0,"z":840},{"t":16,"x":40,"y":0,"z":860},{"t":16,"x":20,"y":0,"z":860},{"t":1,"x":120,"y":0,"z":1100},{"t":1,"x":160,"y":0,"z":1100},{"t":1,"x":200,"y":0,"z":1160},{"t":2,"x":160,"y":0,"z":1160},{"t":3,"x":120,"y":0,"z":1160},{"t":2,"x":120,"y":0,"z":1040},{"t":13,"x":220,"y":0,"z":680},{"t":14,"x":200,"y":0,"z":640},{"t":15,"x":200,"y":0,"z":600},{"t":14,"x":120,"y":0,"z":680},{"t":16,"x":120,"y":0,"z":700},{"t":16,"x":120,"y":0,"z":740},{"t":5,"x":140,"y":0,"z":860},{"t":2,"x":320,"y":0,"z":660},{"t":16,"x":240,"y":0,"z":600},{"t":16,"x":260,"y":0,"z":600},{"t":16,"x":240,"y":0,"z":640},{"t":16,"x":260,"y":0,"z":640},{"t":16,"x":260,"y":0,"z":680},{"t":6,"x":240,"y":0,"z":800},{"t":5,"x":300,"y":0,"z":820},{"t":5,"x":320,"y":0,"z":800},{"t":7,"x":260,"y":0,"z":820},{"t":14,"x":260,"y":0,"z":740},{"t":16,"x":320,"y":0,"z":760},{"t":16,"x":320,"y":0,"z":740},{"t":16,"x":340,"y":0,"z":740},{"t":16,"x":340,"y":0,"z":760},{"t":2,"x":320,"y":0,"z":1240},{"t":16,"x":340,"y":0,"z":1080},{"t":16,"x":320,"y":0,"z":980},{"t":16,"x":340,"y":0,"z":1020},{"t":2,"x":320,"y":0,"z":1060},{"t":2,"x":300,"y":0,"z":1060},{"t":5,"x":240,"y":0,"z":860},{"t":16,"x":260,"y":0,"z":940},{"t":16,"x":280,"y":0,"z":940},{"t":16,"x":300,"y":0,"z":940},{"t":1,"x":440,"y":0,"z":1240},{"t":2,"x":420,"y":0,"z":1060},{"t":2,"x":400,"y":0,"z":1060},{"t":1,"x":360,"y":0,"z":1060},{"t":16,"x":1180,"y":0,"z":60},{"t":16,"x":1120,"y":0,"z":60},{"t":16,"x":1080,"y":0,"z":60},{"t":6,"x":400,"y":0,"z":900},{"t":6,"x":460,"y":0,"z":900},{"t":16,"x":360,"y":0,"z":940},{"t":16,"x":380,"y":0,"z":940},{"t":16,"x":400,"y":0,"z":940},{"t":16,"x":440,"y":0,"z":940},{"t":16,"x":460,"y":0,"z":940},{"t":6,"x":400,"y":0,"z":800},{"t":6,"x":460,"y":0,"z":800},{"t":19,"x":1240,"y":0,"z":200},{"t":15,"x":1220,"y":0,"z":200},{"t":13,"x":1200,"y":0,"z":220},{"t":16,"x":1220,"y":0,"z":280},{"t":16,"x":1080,"y":0,"z":120},{"t":16,"x":1120,"y":0,"z":120},{"t":16,"x":1120,"y":0,"z":160},{"t":16,"x":1120,"y":0,"z":200},{"t":16,"x":1180,"y":0,"z":200},{"t":16,"x":1180,"y":0,"z":160},{"t":16,"x":1180,"y":0,"z":120},{"t":13,"x":380,"y":0,"z":680},{"t":13,"x":360,"y":0,"z":480},{"t":2,"x":360,"y":0,"z":520},{"t":1,"x":360,"y":0,"z":360},{"t":2,"x":400,"y":0,"z":440},{"t":16,"x":440,"y":0,"z":40},{"t":15,"x":460,"y":0,"z":40},{"t":16,"x":460,"y":0,"z":20},{"t":16,"x":380,"y":0,"z":140},{"t":16,"x":420,"y":0,"z":220},{"t":16,"x":1020,"y":0,"z":60},{"t":16,"x":980,"y":0,"z":60},{"t":2,"x":580,"y":0,"z":40},{"t":13,"x":480,"y":0,"z":20},{"t":16,"x":560,"y":0,"z":100},{"t":16,"x":580,"y":0,"z":100},{"t":1,"x":860,"y":0,"z":100},{"t":1,"x":860,"y":0,"z":100},{"t":16,"x":940,"y":0,"z":60},{"t":1,"x":1040,"y":0,"z":220},{"t":1,"x":1040,"y":0,"z":220},{"t":16,"x":980,"y":0,"z":120},{"t":16,"x":1020,"y":0,"z":120},{"t":16,"x":1060,"y":0,"z":200},{"t":15,"x":560,"y":0,"z":140},{"t":16,"x":480,"y":0,"z":120},{"t":16,"x":560,"y":0,"z":220},{"t":3,"x":840,"y":0,"z":200},{"t":16,"x":940,"y":0,"z":120},{"t":16,"x":920,"y":0,"z":200},{"t":2,"x":960,"y":0,"z":320},{"t":2,"x":960,"y":0,"z":320},{"t":16,"x":1040,"y":0,"z":340},{"t":2,"x":620,"y":0,"z":240},{"t":4,"x":660,"y":0,"z":340},{"t":7,"x":600,"y":0,"z":320},{"t":14,"x":640,"y":0,"z":320},{"t":2,"x":620,"y":0,"z":240},{"t":4,"x":660,"y":0,"z":340},{"t":7,"x":600,"y":0,"z":320},{"t":14,"x":640,"y":0,"z":320},{"t":2,"x":620,"y":0,"z":240},{"t":4,"x":660,"y":0,"z":340},{"t":7,"x":600,"y":0,"z":320},{"t":14,"x":640,"y":0,"z":320},{"t":2,"x":620,"y":0,"z":240},{"t":4,"x":660,"y":0,"z":340},{"t":7,"x":600,"y":0,"z":320},{"t":14,"x":640,"y":0,"z":320},{"t":2,"x":620,"y":0,"z":240},{"t":4,"x":660,"y":0,"z":340},{"t":7,"x":600,"y":0,"z":320},{"t":14,"x":640,"y":0,"z":320},{"t":3,"x":760,"y":0,"z":340},{"t":3,"x":800,"y":0,"z":340},{"t":3,"x":760,"y":0,"z":340},{"t":3,"x":800,"y":0,"z":340},{"t":3,"x":760,"y":0,"z":340},{"t":3,"x":800,"y":0,"z":340},{"t":3,"x":760,"y":0,"z":340},{"t":3,"x":800,"y":0,"z":340},{"t":16,"x":800,"y":0,"z":300},{"t":16,"x":900,"y":0,"z":280},{"t":1,"x":480,"y":0,"z":360},{"t":14,"x":600,"y":0,"z":360},{"t":14,"x":600,"y":0,"z":360},{"t":14,"x":600,"y":0,"z":360},{"t":15,"x":660,"y":0,"z":380},{"t":1,"x":560,"y":0,"z":700},{"t":3,"x":560,"y":0,"z":640},{"t":2,"x":620,"y":0,"z":700},{"t":2,"x":620,"y":0,"z":640},{"t":3,"x":660,"y":0,"z":620},{"t":13,"x":700,"y":0,"z":620},{"t":16,"x":520,"y":0,"z":760},{"t":16,"x":500,"y":0,"z":760},{"t":16,"x":500,"y":0,"z":780},{"t":16,"x":520,"y":0,"z":780},{"t":16,"x":520,"y":0,"z":800},{"t":16,"x":520,"y":0,"z":820},{"t":16,"x":600,"y":0,"z":740},{"t":1,"x":560,"y":0,"z":1240},{"t":1,"x":500,"y":0,"z":1240},{"t":16,"x":580,"y":0,"z":1180},{"t":16,"x":540,"y":0,"z":1140},{"t":16,"x":500,"y":0,"z":1100},{"t":16,"x":480,"y":0,"z":940},{"t":16,"x":540,"y":0,"z":940},{"t":16,"x":560,"y":0,"z":940},{"t":16,"x":580,"y":0,"z":940},{"t":16,"x":520,"y":0,"z":840},{"t":16,"x":540,"y":0,"z":840},{"t":16,"x":560,"y":0,"z":840},{"t":16,"x":580,"y":0,"z":840},{"t":16,"x":640,"y":0,"z":1240},{"t":16,"x":620,"y":0,"z":1200},{"t":1,"x":620,"y":0,"z":1240},{"t":2,"x":700,"y":0,"z":1240},{"t":16,"x":700,"y":0,"z":1140},{"t":16,"x":700,"y":0,"z":1180},{"t":16,"x":660,"y":0,"z":1180},{"t":2,"x":640,"y":0,"z":1080},{"t":16,"x":640,"y":0,"z":1120},{"t":16,"x":660,"y":0,"z":1000},{"t":16,"x":640,"y":0,"z":1040},{"t":16,"x":700,"y":0,"z":1040},{"t":1,"x":680,"y":0,"z":1020},{"t":14,"x":700,"y":0,"z":840},{"t":13,"x":680,"y":0,"z":840},{"t":15,"x":660,"y":0,"z":840},{"t":15,"x":640,"y":0,"z":840},{"t":15,"x":620,"y":0,"z":840},{"t":16,"x":600,"y":0,"z":840},{"t":2,"x":760,"y":0,"z":1240},{"t":1,"x":860,"y":0,"z":1240},{"t":2,"x":940,"y":0,"z":1200},{"t":3,"x":920,"y":0,"z":1240},{"t":3,"x":1220,"y":0,"z":1220},{"t":3,"x":1220,"y":0,"z":1200},{"t":2,"x":1100,"y":0,"z":1200},{"t":1,"x":1040,"y":0,"z":1200},{"t":3,"x":1080,"y":0,"z":1240},{"t":3,"x":1000,"y":0,"z":1240},{"t":16,"x":780,"y":0,"z":1120},{"t":16,"x":820,"y":0,"z":1140},{"t":3,"x":1220,"y":0,"z":1180},{"t":2,"x":1220,"y":0,"z":1120},{"t":1,"x":1220,"y":0,"z":1100},{"t":1,"x":1220,"y":0,"z":1080},{"t":16,"x":720,"y":0,"z":1000},{"t":16,"x":780,"y":0,"z":1020},{"t":2,"x":760,"y":0,"z":980},{"t":1,"x":800,"y":0,"z":980},{"t":1,"x":820,"y":0,"z":1040},{"t":2,"x":840,"y":0,"z":1000},{"t":2,"x":900,"y":0,"z":1040},{"t":2,"x":1200,"y":0,"z":1040},{"t":2,"x":1240,"y":0,"z":980},{"t":3,"x":1240,"y":0,"z":960},{"t":2,"x":1140,"y":0,"z":1040},{"t":1,"x":1100,"y":0,"z":1040},{"t":2,"x":1040,"y":0,"z":1040},{"t":1,"x":980,"y":0,"z":1040},{"t":16,"x":1220,"y":0,"z":360},{"t":1,"x":1000,"y":0,"z":360},{"t":1,"x":1000,"y":0,"z":360},{"t":16,"x":760,"y":0,"z":380},{"t":16,"x":800,"y":0,"z":380},{"t":13,"x":940,"y":0,"z":400},{"t":15,"x":940,"y":0,"z":420},{"t":15,"x":1240,"y":0,"z":580},{"t":15,"x":1200,"y":0,"z":580},{"t":15,"x":1100,"y":0,"z":500},{"t":16,"x":1060,"y":0,"z":580},{"t":16,"x":1040,"y":0,"z":580},{"t":16,"x":1020,"y":0,"z":580},{"t":16,"x":1000,"y":0,"z":580},{"t":13,"x":820,"y":0,"z":560},{"t":13,"x":780,"y":0,"z":560},{"t":15,"x":760,"y":0,"z":560},{"t":15,"x":740,"y":0,"z":560},{"t":2,"x":940,"y":0,"z":560},{"t":2,"x":880,"y":0,"z":560},{"t":16,"x":780,"y":0,"z":600},{"t":1,"x":720,"y":0,"z":740},{"t":16,"x":820,"y":0,"z":800},{"t":16,"x":820,"y":0,"z":820},{"t":13,"x":720,"y":0,"z":840},{"t":2,"x":900,"y":0,"z":680},{"t":8,"x":940,"y":0,"z":780},{"t":8,"x":920,"y":0,"z":780},{"t":8,"x":900,"y":0,"z":780},{"t":16,"x":920,"y":0,"z":820},{"t":16,"x":840,"y":0,"z":780},{"t":16,"x":880,"y":0,"z":760},{"t":16,"x":860,"y":0,"z":780},{"t":16,"x":900,"y":0,"z":760},{"t":16,"x":920,"y":0,"z":760},{"t":16,"x":940,"y":0,"z":760},{"t":8,"x":900,"y":0,"z":860},{"t":8,"x":920,"y":0,"z":860},{"t":8,"x":940,"y":0,"z":860},{"t":16,"x":840,"y":0,"z":840},{"t":16,"x":940,"y":0,"z":880},{"t":16,"x":920,"y":0,"z":880},{"t":16,"x":900,"y":0,"z":880},{"t":16,"x":860,"y":0,"z":860},{"t":16,"x":880,"y":0,"z":860},{"t":13,"x":1240,"y":0,"z":700},{"t":16,"x":1080,"y":0,"z":600},{"t":16,"x":1080,"y":0,"z":620},{"t":16,"x":1080,"y":0,"z":640},{"t":15,"x":1020,"y":0,"z":600},{"t":15,"x":1040,"y":0,"z":600},{"t":16,"x":1060,"y":0,"z":640},{"t":16,"x":1040,"y":0,"z":640},{"t":16,"x":1020,"y":0,"z":640},{"t":16,"x":1000,"y":0,"z":640},{"t":16,"x":980,"y":0,"z":640},{"t":16,"x":980,"y":0,"z":620},{"t":16,"x":980,"y":0,"z":600},{"t":2,"x":1220,"y":0,"z":740},{"t":13,"x":1240,"y":0,"z":760},{"t":2,"x":1200,"y":0,"z":800},{"t":13,"x":1220,"y":0,"z":820},{"t":2,"x":1140,"y":0,"z":740},{"t":2,"x":1080,"y":0,"z":740},{"t":2,"x":1140,"y":0,"z":800},{"t":16,"x":1000,"y":0,"z":820},{"t":16,"x":1000,"y":0,"z":800},{"t":16,"x":960,"y":0,"z":760},{"t":16,"x":980,"y":0,"z":780},{"t":16,"x":980,"y":0,"z":820},{"t":16,"x":960,"y":0,"z":820},{"t":3,"x":1240,"y":0,"z":940},{"t":4,"x":1240,"y":0,"z":920},{"t":4,"x":1240,"y":0,"z":900},{"t":4,"x":1240,"y":0,"z":880},{"t":4,"x":1240,"y":0,"z":860},{"t":15,"x":1120,"y":0,"z":860},{"t":15,"x":1080,"y":0,"z":860},{"t":15,"x":1080,"y":0,"z":920},{"t":15,"x":1140,"y":0,"z":920},{"t":13,"x":1180,"y":0,"z":880},{"t":13,"x":1160,"y":0,"z":840},{"t":16,"x":960,"y":0,"z":860},{"t":16,"x":960,"y":0,"z":840}]]'),n=new _(t,o),h=[],l=0;l<=50;l+=1){for(var d=[],p=0;p<=50;p+=1)d.push(3);h.push(d)}n.map=s[0],n.units=s[1],n.removeCopys(),n.makeStatic();var u=n.units.filter((function(t){return t.t>=9&&t.t<=12})),m=new w(n);(Y=new z(0)).lastPos={x:u[0].x,y:u[0].y,z:u[0].z};var x=new c(a,Y),y=new L(t,m,x),f=new M(t,y,m);!function(t){t.addType("tank","Tank",["tank2"],["grid","tankg","tankb"]),t.addType("tankgun","TankGun",["tankgun"],["grid","tankgung","tankgunb"]),t.addType("choper","Choper",["choper"],["grid","choperg","choperb"],["plane"],["elise","elise1"]),t.addType("Barrel","PhysicalObject",["barrel"],["barrel"]),t.addType("truper","Truper",["mans","manl","mans","manr"],["mangreen","manblue","manred"])}(f);var v=new E(m,y,f);!function(t){t.add(1,"tank","Enemy",1),t.add(2,"tankgun","Enemy",1),t.add(3,"choper","Enemy",1),t.add(4,"truper","Enemy",1),t.add(5,"tank","Enemy",0),t.add(6,"tankgun","Enemy",0),t.add(7,"choper","Enemy",0),t.add(8,"truper","Enemy",0),t.add(9,"tank","Player",0),t.add(10,"tankgun","Player",0),t.add(11,"choper","Player",0),t.add(12,"truper","Player",0),t.add(13,"tankgun"),t.add(14,"choper"),t.add(15,"tank"),t.add(16,"Barrel")}(v);var g=0,b=!0,T=0;setInterval((function(){if(T+=.016666666666666666,b){b=!1;var t,e,i,o=T;T=0,g+=1,X.target.x=X.position.x=Y.lastPos.x,X.target.z=Y.lastPos.z,X.position.z=Y.lastPos.z-50,X.matCalctulate(),y.update(o),t=m.teamMembers[0],e=m.teamMembers[1],i=n.units.length,0!=t+e&&(H.innerHTML="Green "+t+" - "+e+" Blue",e<=0&&0==i&&(K.style.visibility="visible")),n.drawStatic(X.target.x,X.target.z),v.draw(n.getUnits(X.target.x,X.target.z)),m.teamMembers[0]=0,m.teamMembers[1]=0,x.update(),g%500==0&&console.log(r.framerate),b=!0}}),16),t.render()}()})),t.onLoaded(W),n.load(),X=t.getCamera("camId",!1),t.onKey("W".charCodeAt(0),(function(){q()}),(function(){tt()})),t.onKey("S".charCodeAt(0),(function(){Z()}),(function(){tt()})),t.onKey("A".charCodeAt(0),(function(){J()}),(function(){et()})),t.onKey("D".charCodeAt(0),(function(){$()}),(function(){et()})),t.onKey("U".charCodeAt(0),(function(){X.position.y-=5,X.matCalctulate()})),t.onKey("I".charCodeAt(0),(function(){X.position.y+=5,X.matCalctulate()})),t.onKey("E".charCodeAt(0),(function(){nt()})),t.onKey(27,(function(){ReloadGame()})),t.onKey(13,(function(){nt()})),t.onKey(32,ot,st),t.onKey(38,(function(){q()}),(function(){tt()})),t.onKey(40,(function(){Z()}),(function(){tt()})),t.onKey(37,(function(){J()}),(function(){et()})),t.onKey(39,(function(){$()}),(function(){et()}))},at(),window.addEventListener("resize",at)})();